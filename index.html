<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Default Title & Favicon (Store for Reset) -->
    <title id="originalTitle">The Unblocked Zone</title>
    <link id="originalFavicon" rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ®</text></svg>"> <!-- Placeholder Favicon -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- ADD CHART.JS LIBRARY -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <!-- Google Sign-In Library -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        /* --- Variables --- */
        :root {
            --bg-color: #0a0f1a;
            --text-color: #e0e0e0;
            /* --- MODIFIED ACCENT COLORS --- */
            --accent-color: #ffffff;              /* WAS: #00ffff (Cyan) */
            --highlight-yellow: #FFD700;          /* Kept Yellow */
            --secondary-blue: #dddddd;            /* WAS: #a0c0ff - Using light gray for secondary elements */
            /* --- MODIFIED BORDER/BG COLORS --- */
            --box-bg: rgba(26, 35, 58, 0.85);
            --box-border: rgba(255, 255, 255, 0.25); /* WAS: rgba(0, 255, 255, 0.25) */
            --description-color: #aabbcc;         /* Kept */
            --icon-bg: rgba(30, 45, 75, 0.6);
            --icon-border: rgba(255, 255, 255, 0.3);  /* WAS: rgba(0, 255, 255, 0.3) */
            --caption-bg: rgba(10, 15, 26, 0.85);
            --player-box-bg: #000000;
            --player-box-border: rgba(255, 255, 255, 0.5); /* WAS: rgba(0, 255, 255, 0.5) */
            --popup-border: rgba(255, 255, 255, 0.4); /* WAS: rgba(0, 255, 255, 0.4) */
            /* --- --- */
            --header-height: 50px;
            --footer-height: 55px;
            --animation-speed: 0.5s; /* Speed for VIEW fade-in/out */
            --overlay-fade-speed: 0.4s; /* Speed for OVERLAY fade-in/out */
            --popup-fade-speed: 0.3s; /* Speed for POPUP fade-in/out */
            --button-bg: rgba(40, 60, 95, 0.7);
            --button-hover-bg: rgba(60, 85, 125, 0.8);
            --button-active-bg: var(--accent-color); /* Will now be white due to --accent-color change */
            --popup-bg: rgba(15, 22, 40, 0.95); /* Darker, more opaque popup bg */
        }


        /* --- General & Header Styles --- */
        body { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Rajdhani', sans-serif; background-color: var(--bg-color); color: var(--text-color); min-height: 100vh; overflow: hidden; position: relative; padding-top: var(--header-height); }
        *, *::before, *::after { box-sizing: inherit; }
        /* Change grid color */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* MODIFIED: Changed grid line color to white */
            background-image: linear-gradient(rgba(255, 255, 255, 0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.3; /* Adjust opacity if needed */
            z-index: -2;
        }
        .main-header { position: fixed; top: 0; left: 0; right: 0; height: var(--header-height); background-color: rgba(10, 15, 26, 0.9); backdrop-filter: blur(5px); border-bottom: 1px solid var(--accent-color); /* Now white border */ z-index: 5000; display: flex; align-items: center; }
        .header-content { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        /* Site Title in Header uses --accent-color, will be white */
        .site-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--accent-color); /* Will now be white */
            text-shadow: 0 0 5px var(--accent-color); /* Glow will now be white */
        }
        .header-controls { display: flex; align-items: center; gap: 10px; /* Spacing between icons */ }
        .header-button { background: none; border: none; color: var(--text-color); font-size: 1.5rem; cursor: pointer; padding: 5px; transition: color 0.2s ease, transform 0.2s ease; }
        .header-button:hover { color: var(--highlight-yellow); transform: scale(1.1); }

        /* --- View Sections --- */
        .view-section {
            position: fixed; top: var(--header-height); left: 0; width: 100%;
            height: calc(100vh - var(--header-height));
            display: flex; flex-direction: column; align-items: center;
            padding: 40px 20px 20px 20px; /* Increased top padding */
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: opacity var(--animation-speed) ease;
            overflow-y: auto; /* Default allow scroll */
            z-index: 1;
        }
        .view-section.active {
            opacity: 1; visibility: visible; pointer-events: auto;
            z-index: 10;
        }
        #home-content, #game-player-section { justify-content: center; }
        #game-section, #help-section, #suggestions-section, #admin-section { justify-content: flex-start; } /* Align content to top */

        /* --- Home Content --- */
        #home-content {
            text-align: center;
            position: relative; /* Needed for absolute positioning of particles */
            z-index: 1;
            overflow: hidden; /* Prevent scrolling on home view */
            padding-top: 20px; /* Restore default padding if needed */
        }
        /* Main title glow */
        .main-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2.5rem, 8vw, 6.5rem);
            font-weight: 700;
            color: #ffffff;
            /* MODIFIED: Changed blue/cyan glow components to white */
            text-shadow: 0 0 8px rgba(200, 220, 255, 0.6), 0 0 15px rgba(255, 255, 255, 0.4), 0 0 25px rgba(255, 255, 255, 0.2);
            margin: 0 0 10px 0;
            line-height: 1.1;
            animation: pulseGlow 4s infinite alternate ease-in-out;
            position: relative;
            z-index: 2; /* Ensure text is above particles */
        }
        .main-title .highlight-yellow { color: var(--highlight-yellow); text-shadow: 0 0 10px rgba(255, 215, 0, 0.8), 0 0 20px rgba(255, 165, 0, 0.6), 0 0 35px rgba(255, 100, 0, 0.3); }
        /* Slogan color (uses --secondary-blue, which we changed to light gray) */
        .slogan {
            font-size: clamp(1rem, 2.5vw, 1.8rem);
            color: var(--secondary-blue); /* Now light gray */
            margin-top: 0;
            margin-bottom: 40px;
            letter-spacing: 1px;
            font-weight: 400;
            text-shadow: 0 0 5px rgba(221, 221, 221, 0.5); /* Adjusted glow for light gray */
            position: relative;
            z-index: 2;
        }
        /* Adjust pulseGlow animation */
        @keyframes pulseGlow {
            from {
                /* MODIFIED: Changed blue/cyan glow components to white */
                text-shadow: 0 0 8px rgba(200, 220, 255, 0.5), 0 0 15px rgba(255, 255, 255, 0.3), 0 0 25px rgba(255, 255, 255, 0.1);
            }
            to {
                /* MODIFIED: Changed blue/cyan glow components to white */
                text-shadow: 0 0 10px rgba(200, 220, 255, 0.7), 0 0 20px rgba(255, 255, 255, 0.5), 0 0 35px rgba(255, 255, 255, 0.3);
            }
        }
        .info-boxes { display: flex; justify-content: center; align-items: stretch; flex-wrap: wrap; gap: 20px; width: 100%; max-width: 1000px; margin-bottom: 50px; position: relative; z-index: 2; }
        .info-box { background-color: var(--box-bg); border: 1px solid var(--box-border); /* Now white border */ border-radius: 10px; padding: 20px 25px; flex: 1 1 28%; min-width: 250px; display: flex; flex-direction: column; align-items: center; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; text-align: center; }
        /* Info box hover shadow */
        .info-box:hover {
            transform: translateY(-6px);
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2);
        }
        /* Info box icon (uses --accent-color, will be white) */
        .info-box i {
            font-size: 2.4rem;
            color: var(--accent-color); /* Now white */
            margin-bottom: 12px;
            /* MODIFIED: Changed glow to white */
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }
        .info-box span.info-title { font-size: 1rem; font-weight: 600; color: var(--text-color); margin-bottom: 8px; display: block; }
        .info-box p.description { font-size: 0.8rem; color: var(--description-color); line-height: 1.4; margin: 0; font-weight: 400; flex-grow: 1; }
        /* Launch Button uses accent-color (white) and highlight-yellow */
        .launch-button {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--bg-color); /* Dark text on light button */
            background: linear-gradient(45deg, var(--accent-color), var(--highlight-yellow)); /* White to Yellow gradient */
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            /* MODIFIED: Changed cyan part of shadow to white */
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4), 0 0 10px rgba(255, 215, 0, 0.3); /* Kept yellow part */
            margin-top: 20px;
            position: relative;
            z-index: 2;
        }
        .launch-button:hover {
            transform: scale(1.05);
            /* MODIFIED: Changed cyan part of shadow to white */
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.6), 0 0 18px rgba(255, 215, 0, 0.5); /* Kept yellow part */
        }
        .launch-button:active { transform: scale(1.02); }

        /* --- Particles.js Container Styling --- */
        #particles-js-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;        /* Position behind the text/buttons but above page background */
        }
        /* Hide particles when home is not active */
        #home-content:not(.active) #particles-js-container {
            display: none;
        }

        /* --- Game Grid Section --- */
        /* Game section title (uses --accent-color, will be white) */
        #game-section h2 {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-color); /* Now white */
            margin: 0 0 20px 0;
            font-size: 2rem;
            text-shadow: 0 0 10px var(--accent-color); /* Glow will be white */
            width: 100%;
            text-align: center;
            flex-shrink: 0;
        }
        .controls-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 20px; margin-bottom: 30px; width: 100%; max-width: 1000px; flex-shrink: 0; }
        /* Category buttons text/hover color (using --secondary-blue -> light gray) */
        .category-filters { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; flex-grow: 1; }
        .category-button {
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--secondary-blue); /* Now light gray */
            background-color: var(--button-bg);
            border: 1px solid var(--box-border); /* Now white-transparent border */
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
        }
        .category-button:hover {
            background-color: var(--button-hover-bg);
            border-color: var(--accent-color); /* Now white */
            color: var(--text-color); /* Keep text color on hover */
        }
        /* Active category button (background uses --accent-color -> white) */
        .category-button.active-category {
            background-color: var(--button-active-bg); /* Now white */
            color: var(--bg-color); /* Use dark bg color for text on white background */
            border-color: var(--button-active-bg); /* White border */
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            animation: none;
        }
        .category-button.rainbow-bg:not(.active-category) { color: #111; border-color: rgba(255,255,255,0.5); background: linear-gradient(90deg, #ff0000, #ffa500, #ffff00, #00ff00, #00ffff, #0000ff, #8a2be2, #ff00ff); background-size: 300% 100%; animation: rainbow-flow-bg 5s linear infinite; transition: none; }
        .category-button.rainbow-bg:hover:not(.active-category) { box-shadow: 0 0 12px rgba(255, 255, 255, 0.4); animation-play-state: paused; }
        @keyframes rainbow-flow-bg { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        /* Sort dropdown label (uses --secondary-blue -> light gray) */
        .sort-container { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
        .sort-container label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--secondary-blue); /* Now light gray */
        }
        /* Sort dropdown arrow color */
        #sortOptions {
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.9rem;
            background-color: var(--button-bg);
            color: var(--text-color);
            border: 1px solid var(--box-border);
            border-radius: 5px;
            padding: 7px 10px;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            /* MODIFIED: Changed arrow fill color to light gray (#dddddd) */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23dddddd'%3E%3Cpath fill-rule='evenodd' d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 12px;
            padding-right: 30px;
        }
        #sortOptions:hover {
            border-color: var(--accent-color); /* Now white */
        }

        /* --- Search Bar Styles (Updated with rounded corners and white theme) --- */
        .search-container {
            position: relative; /* For positioning the icon */
            width: 100%;
            max-width: 450px; /* Increased max-width slightly for better spacing */
            margin-bottom: 15px; /* Add some space below */
        }
        #searchInput {
            width: 100%;
            padding: 10px 20px 10px 45px; /* Top/Bottom, Right, Left (Increased left for icon) */
            font-family: 'Rajdhani', sans-serif; /* Match theme font */
            font-size: 1rem; /* Standard readable size */
            background-color: rgba(10, 15, 26, 0.8); /* Dark, slightly transparent, like header */
            color: var(--text-color); /* Use theme text color */
            border: 1px solid var(--box-border); /* Use white-transparent subtle border */
            border-radius: 25px; /* <<< Makes it fully rounded (pill shape) */
            transition: border-color 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease; /* Smooth transitions */
            backdrop-filter: blur(2px); /* Subtle blur effect matching theme */
        }
        /* Search input focus glow */
        #searchInput:focus {
            outline: none; /* Remove default focus outline */
            border-color: var(--accent-color); /* Highlight white border on focus */
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
            background-color: rgba(26, 35, 58, 0.7); /* Slightly lighter background on focus */
        }
        #searchInput::placeholder {
            color: var(--description-color); /* Use theme placeholder color */
            opacity: 0.6; /* Make placeholder slightly less prominent */
        }
        /* Search icon color (uses --secondary-blue -> light gray) */
        .search-icon {
            position: absolute;
            left: 18px; /* Position icon inside the padding area */
            top: 50%;
            transform: translateY(-50%); /* Vertically center icon */
            color: var(--secondary-blue); /* Now light gray */
            font-size: 1.1rem; /* Adjust icon size */
            pointer-events: none; /* Prevent icon from blocking input clicks */
            opacity: 0.7;
            transition: color 0.2s ease, opacity 0.2s ease; /* Smooth icon transition */
        }
        /* Search icon focus color (uses --accent-color -> white) */
        #searchInput:focus + .search-icon {
             color: var(--accent-color); /* Now white */
             opacity: 1;
        }
        /* Hide the default ugly 'X' clear button on search inputs in Webkit browsers */
        #searchInput::-webkit-search-cancel-button {
            appearance: none;
            -webkit-appearance: none;
        }

        .icon_image { display: flex; flex-wrap: wrap; justify-content: center; column-gap: 25px; row-gap: 15px; padding: 0 20px 20px 20px; width: 100%; max-width: 1200px; flex-grow: 1; overflow-y: auto; align-content: flex-start; }
        .icon_image a { position: relative; display: block; text-decoration: none; background-color: var(--icon-bg); border: 1px solid var(--icon-border); /* White border */ border-radius: 12px; width: 140px; height: 140px; transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.3s ease; overflow: hidden; cursor: pointer; }
        /* Game icon hover effect */
        .icon_image a:hover {
            transform: translateY(-5px) scale(1.03);
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
            /* MODIFIED: Changed border to more opaque white */
            border-color: rgba(255, 255, 255, 0.6);
        }
        .icon_image img { display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 11px; background-color: rgba(255,255,255,0.1); }
        .icon_image figcaption { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%) translateY(5px); width: auto; max-width: 90%; padding: 5px 10px; background-color: var(--caption-bg); color: var(--text-color); border-radius: 6px; font-size: 0.75rem; font-weight: 600; text-align: center; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; z-index: 10; opacity: 0; visibility: hidden; transition: opacity 0.25s ease-out, visibility 0s linear 0.25s, transform 0.25s ease-out; }
        .icon_image a:hover figcaption { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0); transition-delay: 0s; }

        /* --- Custom Scrollbar for Game Grid (Fully Rounded) --- */
        /* Scrollbar colors (using --secondary-blue -> light gray) */
        #icon_image {
            /* Firefox */
            scrollbar-width: thin;
            scrollbar-color: var(--secondary-blue) var(--icon-bg); /* Thumb (light gray), Track */
        }
        /* Webkit (Chrome, Safari, Edge, Opera) */
        #icon_image::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        #icon_image::-webkit-scrollbar-track {
            background: var(--icon-bg);
            border-radius: 10px;
            margin-block: 2px; /* Optional spacing */
        }
        #icon_image::-webkit-scrollbar-thumb {
            background-color: var(--secondary-blue); /* Light gray */
            border-radius: 10px;
            border: 1px solid var(--box-border); /* White-transparent border */
        }
        #icon_image::-webkit-scrollbar-thumb:hover {
            background-color: var(--accent-color); /* White on hover */
        }
        #icon_image::-webkit-scrollbar-corner {
            background: transparent;
        }


        /* --- Game Player --- */
        .game-player-box { display: flex; flex-direction: column; width: 90%; max-width: 1200px; aspect-ratio: 16 / 9; max-height: calc(90vh - var(--header-height)); background-color: var(--player-box-bg); border: 2px solid var(--player-box-border); /* White border */ border-radius: 15px; box-shadow: 0 0 30px rgba(255, 255, 255, 0.3); /* White glow */ overflow: hidden; margin-top: auto; margin-bottom: auto; }
        .iframe-container { width: 100%; flex-grow: 1; overflow: hidden; position: relative; order: 1; }
        #gameFrame { display: block; width: 100%; height: 100%; border: none; background-color: #111; }
        /* Game footer border */
        .game-footer {
            display: flex; align-items: center; justify-content: space-between; background-color: rgba(10, 15, 26, 0.9);
            /* MODIFIED: Changed border color to white-transparent */
            border-top: 1px solid rgba(255, 255, 255, 0.4);
            padding: 0 15px; height: var(--footer-height); width: 100%; flex-shrink: 0; order: 2;
        }
        .game-info { text-align: left; flex-grow: 1; margin-right: 15px; overflow: hidden; }
        /* Current game title (uses --accent-color -> white) */
        #currentGameTitle {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: var(--text-color); /* Keep primary text color */
            text-shadow: 0 0 5px var(--accent-color); /* White glow */
            display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        #currentGameCreator { font-size: 0.75rem; color: var(--description-color); display: block; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .game-controls { display: flex; gap: 10px; flex-shrink: 0; }
        /* Back/Fullscreen buttons (uses --accent-color -> white) */
        #backButton, #fullscreenButton {
            background: none; border: none;
            color: var(--accent-color); /* Now white */
            font-size: 1.4rem; cursor: pointer; padding: 8px; transition: color 0.2s ease, transform 0.2s ease;
        }
        #backButton:hover, #fullscreenButton:hover { color: var(--highlight-yellow); transform: scale(1.1); }

        /* --- Transition Overlay --- */
        .transition-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #f0f0f0; opacity: 0; visibility: hidden; pointer-events: none; z-index: 10000; transition: opacity var(--overlay-fade-speed) ease-in-out, visibility 0s linear var(--overlay-fade-speed); }
        .transition-overlay.active { opacity: 1; visibility: visible; transition-delay: 0s; }

        /* --- Settings/Support/Edit Popup Common Styles --- */
        .settings-overlay { /* Used by settings, support & edit game */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); z-index: 5999; /* Base overlay z-index */
            opacity: 0; visibility: hidden;
            transition: opacity var(--popup-fade-speed) ease, visibility 0s linear var(--popup-fade-speed);
            backdrop-filter: blur(3px);
        }
        /* Popup shadow */
        .settings-popup { /* Base style for settings, support & edit game */
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background-color: var(--popup-bg); border: 1px solid var(--popup-border); /* White border */
            border-radius: 15px; padding: 25px 30px;
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 5px 25px rgba(255, 255, 255, 0.15); z-index: 6000; /* Base popup z-index */
            width: 90%; max-width: 450px; /* Default max width */
            opacity: 0; visibility: hidden;
            transition: opacity var(--popup-fade-speed) ease, transform var(--popup-fade-speed) ease, visibility 0s linear var(--popup-fade-speed);
            overflow-y: auto; /* Allow popup content to scroll if needed */
            max-height: 90vh; /* Prevent popup being taller than viewport */
        }
        .settings-overlay.visible, .settings-popup.visible {
            opacity: 1; visibility: visible; transition-delay: 0s;
        }
        .settings-popup.visible { transform: translate(-50%, -50%) scale(1); }
        .settings-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--box-border); /* White border */ }
        /* Popup title (uses --accent-color -> white) */
        .settings-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            color: var(--accent-color); /* Now white */
            margin: 0;
        }
        /* Close button (uses --secondary-blue -> light gray) */
        #closeSettingsButton, #closeSupportFormBtn, #closeEditGameModal {
            background: none; border: none;
            color: var(--secondary-blue); /* Now light gray */
            font-size: 1.6rem; cursor: pointer; padding: 0 5px; line-height: 1; transition: color 0.2s ease, transform 0.2s ease;
        }
        #closeSettingsButton:hover, #closeSupportFormBtn:hover, #closeEditGameModal:hover { color: var(--highlight-yellow); transform: scale(1.1); }
        .settings-content { padding-top: 10px; } /* Add some space below header */
        .settings-section { margin-bottom: 25px; }
        /* Setting section title (uses --secondary-blue -> light gray) */
        .settings-section h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: var(--secondary-blue); /* Now light gray */
            margin-top: 0; margin-bottom: 15px; font-weight: 600;
            /* MODIFIED: Changed dashed border to white-transparent */
            border-bottom: 1px dashed rgba(255, 255, 255, 0.2);
            padding-bottom: 5px;
        }
        .tab-cloak-options { display: flex; flex-direction: column; gap: 12px; }
        .tab-cloak-option { display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 8px; border-radius: 5px; transition: background-color 0.2s ease; background-color: rgba(255, 255, 255, 0.03); }
        .tab-cloak-option:hover { background-color: rgba(255, 255, 255, 0.08); }
        /* Tab cloak radio button border (uses --secondary-blue -> light gray) */
        .tab-cloak-option input[type="radio"] {
            appearance: none; -webkit-appearance: none; margin: 0; width: 16px; height: 16px;
            border: 2px solid var(--secondary-blue); /* Now light gray */
            border-radius: 50%; cursor: pointer; position: relative; transition: border-color 0.2s ease, background-color 0.2s ease;
        }
        /* Tab cloak radio button checked state (uses --accent-color -> white) */
        .tab-cloak-option input[type="radio"]:checked {
            border-color: var(--accent-color); /* Now white */
            background-color: var(--accent-color); /* Now white */
        }
        .tab-cloak-option input[type="radio"]:checked::after { content: ''; display: block; width: 6px; height: 6px; background-color: var(--popup-bg); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .tab-cloak-option label { font-size: 0.9rem; color: var(--text-color); flex-grow: 1; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .tab-cloak-option label img { width: 16px; height: 16px; vertical-align: middle; }
        .settings-actions { display: flex; justify-content: flex-end; gap: 15px; margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--box-border); /* White border */ }
        .settings-button { font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; font-weight: 600; padding: 8px 20px; border-radius: 20px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease; border: 1px solid var(--box-border); /* White border */ }
        /* Apply cloak button (uses --button-active-bg -> white) */
        #applyCloakButton {
            background-color: var(--button-active-bg); /* Now white */
            color: var(--bg-color); /* Dark text */
            border-color: var(--button-active-bg); /* White border */
        }
        #applyCloakButton:hover {
            background-color: #f0f0f0; /* Slightly off-white hover */
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        /* Reset cloak button (uses --secondary-blue -> light gray) */
        #resetCloakButton {
            background-color: var(--button-bg);
            color: var(--secondary-blue); /* Now light gray */
        }
        #resetCloakButton:hover {
            background-color: var(--button-hover-bg);
            color: var(--text-color);
            border-color: var(--accent-color); /* Now white */
        }

        /* --- Help Section Buttons --- */
        .help-options-container {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            justify-content: center;
            gap: 30px; /* Space between buttons */
            width: 100%;
            max-width: 800px; /* Limit container width */
        }
        /* Help button shadow */
        .help-button {
            background-color: var(--box-bg); border: 1px solid var(--box-border); /* White border */
            border-radius: 15px; color: var(--text-color); text-decoration: none;
            padding: 30px 25px; min-width: 220px; min-height: 150px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; transition: all 0.3s ease;
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.05);
            position: relative; overflow: hidden; /* Needed for potential pseudo-element effects */
        }
        /* Help button icon (uses --accent-color -> white) */
        .help-button i {
            font-size: 2.8rem;
            color: var(--accent-color); /* Now white */
            margin-bottom: 15px;
            /* MODIFIED: Changed glow to white */
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.4);
            transition: transform 0.3s ease;
        }
        .help-button span {
            font-family: 'Orbitron', sans-serif; font-size: 1.2rem; font-weight: 600;
            display: block; margin-bottom: 5px;
        }
        .help-button small { font-size: 0.8rem; color: var(--description-color); line-height: 1.3; }
        /* Help button hover */
        .help-button:hover {
            transform: translateY(-6px) scale(1.03);
            border-color: var(--accent-color); /* Now white */
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
        }
        .help-button:hover i { transform: scale(1.1); }
        /* --- Button Animation (Example: Pulse Glow) --- */
        /* Help button animation */
        @keyframes pulseGlowEffect {
            0% { box-shadow: 0 4px 15px rgba(255, 255, 255, 0.05); } /* White glow */
            50% { box-shadow: 0 6px 20px rgba(255, 255, 255, 0.15); } /* White glow */
            100% { box-shadow: 0 4px 15px rgba(255, 255, 255, 0.05); } /* White glow */
        }
        .animated-button { animation: pulseGlowEffect 4s infinite alternate ease-in-out; }
        .help-button:hover { animation-play-state: paused; }

        /* --- Support Form Specific Styles --- */
        /* Form labels (uses --secondary-blue -> light gray) */
        #supportFormPopup label {
            display: block; margin-bottom: 5px; font-weight: 600;
            color: var(--secondary-blue); /* Now light gray */
            font-size: 0.9rem;
        }
        #supportFormPopup input[type="text"],
        #supportFormPopup input[type="url"],
        #supportFormPopup textarea {
             border-color: var(--box-border); /* White border */
             width: 100%; padding: 8px 10px; background-color: var(--button-bg);
             border: 1px solid var(--box-border); border-radius: 5px;
             color: var(--text-color); font-family: 'Rajdhani', sans-serif; font-size: 0.9rem;
        }
        #supportFormPopup textarea { resize: vertical; }
        /* Form input focus */
        #supportFormPopup input[type="text"]:focus,
        #supportFormPopup input[type="url"]:focus,
        #supportFormPopup textarea:focus {
             outline: none;
             border-color: var(--accent-color); /* Now white */
             /* MODIFIED: Changed glow to white */
             box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }
        #supportFormPopup .settings-content { padding-top: 10px; }

        /* --- URL Preview Styles --- */
        .url-preview {
            margin-top: 8px;
            border: 1px dashed var(--box-border); /* White border */
            border-radius: 5px;
            padding: 5px;
            min-height: 50px; /* Ensure space even when empty */
            display: flex;
            flex-direction: column; /* Stack preview and text */
            align-items: center;
            background-color: rgba(0,0,0, 0.2); /* Dark bg for preview area */
            position: relative; /* For overlay text */
        }
        .url-preview span { /* Help text for preview */
            font-size: 0.7rem;
            color: var(--description-color);
            margin-top: 4px;
            display: block; /* Initially show */
            text-align: center;
        }
        /* Game Preview (Iframe) */
        #gameUrlPreview iframe {
            width: 100%;
            max-width: 300px; /* Limit preview width */
            height: 150px; /* Adjust height as needed */
            border: none;
            display: none; /* Hide initially */
            background-color: #222; /* Dark bg while loading */
        }
        #gameUrlPreview iframe[src]:not([src="about:blank"]) {
             display: block; /* Show iframe only when src is set */
        }
        #gameUrlPreview iframe[src]:not([src="about:blank"]) + span { /* Hide text span when iframe is shown */
            display: none;
        }
        /* Icon Preview (Image) */
         #iconUrlPreview img, #editIconPreview img {
            max-width: 64px;
            max-height: 64px;
            display: none; /* Hide initially */
            object-fit: contain; /* Prevent distortion */
            margin-bottom: 5px; /* Space between img and text */
        }
        #iconUrlPreview img[src]:not([src=""]), #editIconPreview img[src]:not([src=""]) {
             display: block; /* Show image only when src is set */
        }
        #iconUrlPreview img[src]:not([src=""]) + span, #editIconPreview img[src]:not([src=""]) + span { /* Hide text span when image shown */
            display: none;
        }
        /* --- Support Form Popup Styles --- */
        #supportFormOverlay { z-index: 6999; } /* Below its popup */
        #supportFormPopup {
            z-index: 7000; /* Above its overlay */
            max-width: 550px; /* Slightly wider for form */
        }
        /* Submit button (uses --accent-color -> white) */
        #submitSupportButton {
            background-color: var(--accent-color); /* Now white */
            color: var(--bg-color); /* Dark text */
            border-color: var(--accent-color); /* White border */
            display: block;
            margin-left: auto;
            /* Re-apply base settings-button styles */
            font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; font-weight: 600; padding: 8px 20px; border-radius: 20px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease; border: 1px solid var(--accent-color);
        }
        #submitSupportButton:hover {
            background-color: #f0f0f0; /* Slightly off-white hover */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* White glow */
        }


        /* --- Finder View Styles --- */
        #suggestions-section > h2 { /* Target main heading */
             margin-bottom: 30px; /* Spacing below title */
             color: var(--accent-color); /* White title */
             font-family: 'Orbitron', sans-serif;
        }

        .finder-step {
            width: 100%;
            max-width: 900px;
            display: none; /* Hide steps by default */
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }
        .finder-step.active-step {
            display: flex; /* Show the active step */
            animation: fadeIn 0.5s ease-in-out; /* Optional fade */
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Step titles (uses --secondary-blue -> light gray) */
        .finder-step h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--secondary-blue); /* Now light gray */
            font-size: 1.6rem;
            margin-bottom: 30px;
            text-align: center;
            width: 100%;
        }
         /* Step title icons (uses --accent-color -> white) */
         .finder-step h3 i {
            margin-right: 10px;
            color: var(--accent-color); /* Now white */
         }


        /* Player Count Step Buttons */
        .step-options-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 25px;
            width: 100%;
        }
        .step-button {
            background-color: var(--box-bg);
            border: 1px solid var(--box-border); /* White border */
            border-radius: 15px;
            color: var(--text-color);
            text-decoration: none;
            padding: 25px;
            min-width: 180px;
            width: calc(33% - 20px); /* Adjusted for 3 buttons */
            min-height: 130px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
         /* Step button icons (uses --accent-color -> white) */
         .step-button i {
            font-size: 2.5rem;
            color: var(--accent-color); /* Now white */
            margin-bottom: 12px;
            /* MODIFIED: Changed glow to white */
            text-shadow: 0 0 6px rgba(255, 255, 255, 0.3);
            transition: transform 0.2s ease;
        }
        .step-button span {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            display: block;
            margin-bottom: 4px;
        }
         .step-button small {
            font-size: 0.75rem;
            color: var(--description-color);
            line-height: 1.3;
        }
         /* Step button hover */
        .step-button:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color); /* Now white */
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 6px 18px rgba(255, 255, 255, 0.15);
        }
         .step-button:hover i {
            transform: scale(1.1);
        }

        /* Adapt category filters for the finder */
        .finder-categories {
             max-width: 700px; /* Limit width slightly */
             margin-top: 15px;
         }

        /* Results Styles */
        #finder-results-container {
             display: flex;
             flex-wrap: wrap;
             gap: 20px;
             justify-content: center;
             width: 100%;
         }

        .finder-result-item {
            background-color: var(--box-bg);
            border: 1px solid var(--box-border); /* White border */
            border-radius: 10px;
            padding: 15px;
            width: calc(50% - 20px); /* Two columns */
            max-width: 350px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
         /* Finder result item hover */
         .finder-result-item:hover {
            transform: translateY(-4px);
            /* MODIFIED: Changed glow to white */
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
         }

        .finder-result-item img {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 8px;
            flex-shrink: 0; /* Prevent image shrinking */
        }

        .finder-result-info {
            flex-grow: 1;
            text-align: left;
            overflow: hidden; /* Prevent long text overflow */
        }

        .finder-result-info h4 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: var(--text-color);
            margin: 0 0 4px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .finder-result-info small.finder-result-creator {
             font-size: 0.75rem;
             color: var(--description-color);
             display: block;
             margin-bottom: 4px; /* Adjusted */
             white-space: nowrap;
             overflow: hidden;
             text-overflow: ellipsis;
        }

         /* Style category tags in results */
        .finder-result-categories {
            margin-top: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        /* Finder category tags (uses --secondary-blue -> light gray) */
        .finder-result-categories span {
            font-size: 0.7rem;
            background-color: var(--button-bg);
            color: var(--secondary-blue); /* Now light gray */
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid var(--box-border); /* White border */
        }

        /* Finder play button (uses --button-active-bg -> white) */
        .finder-result-play-btn {
             font-family: 'Rajdhani', sans-serif;
             font-size: 0.8rem;
             font-weight: 600;
             background-color: var(--button-active-bg); /* Now white */
             color: var(--bg-color); /* Dark text */
             border: none;
             padding: 6px 15px;
             border-radius: 15px;
             cursor: pointer;
             transition: background-color 0.2s ease;
             flex-shrink: 0; /* Prevent button shrinking */
             margin-left: 10px; /* Ensure some space if things wrap */
         }
         /* Finder play button hover */
         .finder-result-play-btn:hover {
            background-color: #f0f0f0; /* Slightly off-white hover */
         }


         /* Admin Section Styles */
        #admin-section {
            justify-content: flex-start;
            align-items: center; /* Center content vertically */
            width: 100%; /* Ensure section takes full width */
        }
        #admin-section h2 {
             text-shadow: 0 0 8px var(--highlight-yellow); /* Add yellow glow to admin title */
             font-family: 'Orbitron', sans-serif;
             color: var(--highlight-yellow); /* Yellow title */
             width: 100%; /* Make title take full width */
             max-width: 1100px; /* Align with dashboard max-width */
             text-align: center; /* Center title */
             margin-bottom: 10px; /* Adjust spacing */
        }
         #admin-section > p { /* Target the main paragraph */
            width: 100%; /* Make paragraph take full width */
            max-width: 1100px; /* Align with dashboard max-width */
            text-align: center; /* Center paragraph */
         }

         /* --- Admin Dashboard Styles --- */
         #admin-dashboard {
             display: flex;
             flex-wrap: wrap; /* Allow wrapping on smaller screens */
             gap: 25px;
             width: 100%;
             max-width: 1100px; /* Adjust max width as needed */
             margin-bottom: 40px; /* Space below dashboard */
             padding: 20px;
             background-color: rgba(26, 35, 58, 0.5); /* Slightly different background */
             border: 1px solid var(--box-border); /* White border */
             border-radius: 10px;
         }

         #admin-stats,
         #admin-chart-container {
             flex: 1 1 400px; /* Allow flex grow/shrink, base width 400px */
             min-width: 300px; /* Prevent getting too small */
         }

         #admin-stats h3,
         #admin-chart-container h3 {
             font-family: 'Orbitron', sans-serif;
             color: var(--secondary-blue); /* Light gray */
             font-size: 1.2rem;
             margin-top: 0;
             margin-bottom: 20px;
             padding-bottom: 8px;
             border-bottom: 1px solid var(--box-border); /* White border */
         }

         .stat-item {
             background-color: var(--box-bg); /* Use standard box background */
             border: 1px solid var(--icon-border); /* Slightly dimmer white border */
             border-radius: 8px;
             padding: 12px 15px;
             margin-bottom: 12px;
             display: flex;
             justify-content: space-between;
             align-items: center;
             flex-wrap: wrap; /* Allow wrapping inside item */
             gap: 10px;
         }

         .stat-label {
             font-weight: 600;
             color: var(--text-color);
             font-size: 0.9rem;
         }
         .stat-label i {
             margin-right: 8px;
             color: var(--accent-color); /* White icon */
             width: 15px; /* Align icons */
             text-align: center;
         }


         .stat-value {
             font-family: 'Orbitron', sans-serif;
             font-size: 1.3rem;
             font-weight: 700;
             color: var(--highlight-yellow); /* Yellow for value */
             margin-left: auto; /* Push value to the right */
             padding-left: 10px; /* Space before value */
         }

         .stat-item small {
            font-size: 0.7rem;
            color: var(--description-color);
            width: 100%; /* Make small text take full width */
            text-align: right; /* Align small text to the right */
            margin-top: -5px; /* Adjust spacing */
         }

         #admin-chart-container {
             background-color: var(--box-bg);
             padding: 20px;
             border-radius: 8px;
             border: 1px solid var(--icon-border);
             display: flex;
             flex-direction: column;
             align-items: center;
         }

         #categoryChartCanvas {
             max-width: 100%;
             max-height: 350px; /* Limit chart height */
         }
         /* End Admin Dashboard Styles */

        /* --- Admin Game Manager Styles --- */
        #admin-game-manager {
            width: 100%;
            max-width: 1100px; /* Match dashboard width */
            margin-bottom: 40px;
            padding: 20px;
            background-color: rgba(26, 35, 58, 0.5);
            border: 1px solid var(--box-border);
            border-radius: 10px;
        }

        #admin-game-manager h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--secondary-blue);
            font-size: 1.2rem;
            margin-top: 0;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--box-border);
        }

        .game-manager-table-container {
            max-height: 50vh; /* Limit table height and make scrollable */
            overflow-y: auto;
            border: 1px solid var(--icon-border);
            border-radius: 5px;
             /* Custom Scrollbar for table container */
            scrollbar-width: thin;
            scrollbar-color: var(--secondary-blue) var(--icon-bg);
        }
        .game-manager-table-container::-webkit-scrollbar { width: 8px; height: 8px; }
        .game-manager-table-container::-webkit-scrollbar-track { background: var(--icon-bg); border-radius: 10px; }
        .game-manager-table-container::-webkit-scrollbar-thumb { background-color: var(--secondary-blue); border-radius: 10px; border: 1px solid var(--box-border); }
        .game-manager-table-container::-webkit-scrollbar-thumb:hover { background-color: var(--accent-color); }

        #game-manager-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        #game-manager-table thead th {
            background-color: var(--box-bg);
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            color: var(--secondary-blue);
            position: sticky; /* Keep header visible on scroll */
            top: 0;
            z-index: 1;
        }

        #game-manager-table tbody td {
            padding: 8px;
            border-bottom: 1px solid var(--icon-border);
            vertical-align: middle;
        }

        #game-manager-table tbody tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.03);
        }
        #game-manager-table tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }


        #game-manager-table .game-icon-cell img {
            width: 32px;
            height: 32px;
            object-fit: cover;
            border-radius: 4px;
            vertical-align: middle;
        }

        #game-manager-table .game-categories-cell {
            max-width: 150px; /* Limit width */
            white-space: normal; /* Allow wrapping */
        }
        #game-manager-table .game-categories-cell span {
            display: inline-block;
            background-color: var(--button-bg);
            color: var(--description-color);
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin: 2px;
        }

        #game-manager-table .game-url-cell {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        #game-manager-table .game-url-cell a {
            color: var(--secondary-blue);
            text-decoration: none;
        }
        #game-manager-table .game-url-cell a:hover {
            text-decoration: underline;
            color: var(--accent-color);
        }


        #game-manager-table .actions-cell button {
            background: none;
            border: none;
            color: var(--secondary-blue);
            font-size: 1rem;
            cursor: pointer;
            padding: 3px 6px;
            margin: 0 3px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #game-manager-table .actions-cell button:hover {
            transform: scale(1.1);
        }
        #game-manager-table .actions-cell .edit-btn:hover {
            color: var(--highlight-yellow);
        }
        #game-manager-table .actions-cell .delete-btn:hover {
            color: #f08080; /* LightCoral */
        }

        /* Edit Game Modal Styles */
        #editGameModal {
             max-width: 600px; /* Wider modal for form */
             z-index: 6010; /* Above its overlay */
        }
        #editGameOverlay {
            z-index: 6005; /* Below modal */
        }

        #editGameForm label {
             display: block; margin-bottom: 5px; font-weight: 600;
             color: var(--secondary-blue); font-size: 0.9rem;
        }
        #editGameForm input[type="text"],
        #editGameForm input[type="url"] {
             width: 100%; padding: 8px 10px; background-color: var(--button-bg);
             border: 1px solid var(--box-border); border-radius: 5px;
             color: var(--text-color); font-family: 'Rajdhani', sans-serif; font-size: 0.9rem;
        }
        #editGameForm input[type="text"]:focus,
        #editGameForm input[type="url"]:focus {
             outline: none; border-color: var(--accent-color);
             box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        #editIconPreview img { display: none; } /* Hide preview img initially */
        #editIconPreview img[src]:not([src=""]) { display: block; } /* Show only if src set */
        #editIconPreview img[src]:not([src=""]) + span { display: none; } /* Hide text span when image shown */

        .edit-categories {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid var(--box-border);
            border-radius: 5px;
            padding: 10px;
            background-color: rgba(0,0,0,0.2);
             /* Custom Scrollbar */
            scrollbar-width: thin;
            scrollbar-color: var(--secondary-blue) var(--icon-bg);
        }
        .edit-categories::-webkit-scrollbar { width: 6px; }
        .edit-categories::-webkit-scrollbar-track { background: var(--icon-bg); border-radius: 10px; }
        .edit-categories::-webkit-scrollbar-thumb { background-color: var(--secondary-blue); border-radius: 10px; border: 1px solid var(--box-border); }

        .edit-categories label {
            display: block; /* One category per line */
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: var(--text-color);
            cursor: pointer;
            font-weight: normal; /* Override default label weight */
        }
        .edit-categories input[type="checkbox"] {
            margin-right: 8px;
            accent-color: var(--accent-color); /* Style checkbox color */
            vertical-align: middle;
        }

        .edit-player-options label {
            display: inline-block; /* Keep radios inline */
            margin-right: 15px;
            font-size: 0.9rem;
            font-weight: normal;
            color: var(--text-color);
            cursor: pointer;
        }
        .edit-player-options input[type="radio"] {
            margin-right: 5px;
            accent-color: var(--accent-color);
            vertical-align: middle;
        }


        #saveGameChanges {
            background-color: var(--highlight-yellow) !important; /* Ensure yellow wins */
            color: var(--bg-color) !important;
            border-color: var(--highlight-yellow) !important;
        }
        #saveGameChanges:hover {
            background-color: #e6c300 !important; /* Darker yellow */
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5) !important;
        }
        /* End Game Manager Styles */


        .admin-actions { /* Now below manager */
             margin-top: 30px; /* Restore margin-top */
             width: 100%;
             max-width: 500px; /* Keep actions centered below */
             margin-left: auto;
             margin-right: auto;
        }
        .admin-actions button {
            padding: 10px 20px;
            font-size: 1rem;
        }
        /* Test All Games button uses secondary-blue -> light gray */
        #testAllGamesBtn {
           background-color: var(--secondary-blue) !important; /* Override default button style slightly */
           color: var(--bg-color) !important;
           border-color: var(--secondary-blue) !important;
        }
        #testAllGamesBtn:hover {
           background-color: #cccccc !important; /* Slightly darker gray hover */
           box-shadow: 0 0 10px rgba(221, 221, 221, 0.5) !important;
        }
        #gameTestResults {
            line-height: 1.6;
            background-color: var(--box-bg);
            border: 1px solid var(--box-border); /* White border */
            padding: 15px; border-radius: 8px; max-height: 40vh; overflow-y: auto; font-size: 0.8rem; display: none;
            width: 100%; /* Make results take full width of container */
            margin-top: 15px; /* Add space above results */
        }
        #gameTestResults div {
            padding: 3px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1); /* White dashed */
        }
        #gameTestResults div:last-child {
            border-bottom: none;
        }
        #gameTestResults .status-ok { color: #8fbc8f; } /* DarkSeaGreen */
        #gameTestResults .status-error { color: #f08080; } /* LightCoral */


        /* --- Responsive Adjustments --- */
         @media (max-width: 1100px) {
             .info-box { flex-basis: 45%; min-width: 220px; }
             #admin-game-manager, #admin-dashboard { max-width: 95%; } /* Allow manager/dashboard to be wider */
         }
         @media (max-width: 900px) {
            #admin-dashboard {
                flex-direction: column; /* Stack elements */
            }
            #admin-stats,
            #admin-chart-container {
                flex-basis: auto; /* Reset flex basis */
                width: 100%;
            }
         }
         @media (max-width: 768px) {
             .header-content { padding: 0 15px; }
             .site-title { font-size: 1.2rem; }
             .header-button { font-size: 1.3rem; }
             .main-title { font-size: clamp(2rem, 10vw, 4.5rem); }
             .slogan { font-size: clamp(0.9rem, 3vw, 1.5rem); }
             .info-boxes { gap: 15px; }
             .info-box { flex-basis: 100%; min-width: unset; padding: 15px 20px; }
             .launch-button { font-size: 1.2rem; padding: 12px 30px; }
             .controls-container { flex-direction: column; gap: 15px; }
             .category-filters { gap: 8px; }
             .category-button { font-size: 0.8rem; padding: 6px 15px; }
             .sort-container { margin-top: 10px; }
             #game-section h2, #help-section h2, #suggestions-section h2, #admin-section h2 { font-size: 1.8rem; }
             .game-player-box { width: 95%; }
             .game-footer { height: auto; flex-direction: column; padding: 10px; text-align: center; gap: 8px;}
             .game-info { margin-right: 0; margin-bottom: 5px; }
             #currentGameTitle { font-size: 0.9rem; }
             #currentGameCreator { font-size: 0.7rem; }
             #backButton, #fullscreenButton { font-size: 1.2rem; padding: 5px; }
             .help-options-container { flex-direction: column; gap: 20px; }
             .help-button { min-width: unset; width: 80%; padding: 20px; min-height: unset; }
             .settings-popup, #supportFormPopup, #editGameModal { width: 95%; padding: 20px; max-width: 95%; }
             .settings-title { font-size: 1.1rem; }
             #closeSettingsButton, #closeSupportFormBtn, #closeEditGameModal { font-size: 1.4rem; }
             #userPicture { width: 25px; height: 25px;}
             #userName { font-size: 0.75rem; }
             #signOutButton { font-size: 1rem; }
             #icon_image { column-gap: 15px; row-gap: 10px; padding: 0 10px 10px 10px;}
             .icon_image a { width: 110px; height: 110px; border-radius: 10px; }
             .icon_image img { border-radius: 9px; }
             .icon_image figcaption { font-size: 0.7rem; bottom: 5px; padding: 4px 8px; }
             .finder-result-item { width: calc(100% - 10px); max-width: none; } /* Finder results full width */
             #admin-dashboard { padding: 15px; } /* Reduce padding */
             #admin-game-manager { padding: 15px; }
             #admin-stats h3, #admin-chart-container h3, #admin-game-manager h3 { font-size: 1.1rem; }
             .admin-actions { max-width: 90%; } /* Allow actions to take more width */
              /* Hide less important columns on smaller tables */
             #game-manager-table .game-url-cell,
             #game-manager-table th:nth-child(6) { display: none; } /* Hide URL */
             #game-manager-table .game-categories-cell,
             #game-manager-table th:nth-child(4) { max-width: 100px; } /* Reduce category width */
             #game-manager-table .game-players-cell,
             #game-manager-table th:nth-child(5) { display: none; } /* Hide Players */
         }
         @media (max-width: 480px) {
            :root { --header-height: 45px; --footer-height: 45px;} /* Slightly reduce heights */
             .site-title { display: none; } /* Hide title on very small screens */
             .header-content { justify-content: flex-end; } /* Align icons right */
             .header-button { font-size: 1.2rem; }
             #googleSignInContainer { gap: 5px; }
             #userInfo { gap: 4px; }
             #userPicture { width: 22px; height: 22px;}
             #signOutButton { font-size: 0.9rem; }
             .launch-button { font-size: 1.1rem; padding: 10px 25px; }
             .category-button { font-size: 0.75rem; padding: 5px 12px; border-radius: 15px; }
             .search-container { max-width: 90%; }
             #searchInput { font-size: 0.9rem; padding: 8px 15px 8px 40px; }
             .search-icon { left: 15px; font-size: 1rem;}
             .icon_image a { width: calc(50% - 10px); height: auto; aspect-ratio: 1 / 1; } /* 2 columns */
             .icon_image figcaption { display: none; } /* Hide captions on mobile */
             .icon_image a:hover figcaption { display: none; } /* Ensure hover doesn't show it */
             .game-player-box { border-width: 1px; border-radius: 10px; }
             .settings-popup, #supportFormPopup, #editGameModal { max-width: 98%; }
             .step-button { width: calc(50% - 15px); min-width: 140px; } /* Finder step buttons */
             .stat-item { flex-direction: column; align-items: flex-start; gap: 5px; } /* Stack stats vertically */
             .stat-value { margin-left: 0; padding-left: 0; margin-top: 5px; font-size: 1.2rem; }
             .stat-item small { text-align: left; margin-top: 0; }
             /* Hide more columns on smallest screens */
             #game-manager-table .game-categories-cell,
             #game-manager-table th:nth-child(4) { display: none; } /* Hide Categories */
             #game-manager-table .game-icon-cell,
             #game-manager-table th:nth-child(1) { display: none; } /* Hide Icon */
             #game-manager-table .game-players-cell,
             #game-manager-table th:nth-child(5) { display: none; } /* Hide Players */
             #game-manager-table tbody td { padding: 6px 4px; } /* Reduce padding */
             #game-manager-table { font-size: 0.75rem; }
             .edit-categories { max-height: 100px;}
         }

    </style>
</head>
<body>

    <header id="main-header" class="main-header">
        <div class="header-content">
             <span class="site-title">The Unblocked Zone</span>
             <div class="header-controls">
                 <!-- Google Sign In/Out Area -->
                 <div id="googleSignInContainer" style="display: flex; align-items: center; gap: 10px;">
                    <!-- Google Button will render here -->
                    <div id="buttonDiv"></div>
                    <!-- User Info / Sign Out Button (Initially Hidden) -->
                    <div id="userInfo" style="display: none; align-items: center; gap: 8px;">
                        <img id="userPicture" src="" alt="User" style="width: 30px; height: 30px; border-radius: 50%;">
                        <span id="userName" style="font-size: 0.8rem; color: var(--secondary-blue); max-width: 100px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"></span>
                        <button id="signOutButton" class="header-button" title="Sign Out" style="font-size: 1.2rem;"><i class="fas fa-sign-out-alt"></i></button>
                    </div>
                 </div>
                 <!-- End Google Sign In/Out -->

                 <button id="adminButton" class="header-button" title="Admin Panel" style="display: none;"> <!-- Initially hidden -->
                    <i class="fas fa-user-shield"></i>
                 </button>
                 <button id="suggestionsButton" class="header-button" title="Suggestions">
                    <i class="fas fa-lightbulb"></i>
                 </button>
                 <button id="helpButton" class="header-button" title="Help & Support">
                    <i class="fas fa-question-circle"></i>
                 </button>
                 <button id="settingsButton" class="header-button" title="Settings">
                    <i class="fas fa-cog"></i>
                 </button>
                 <button id="homeButton" class="header-button" title="Go Home">
                    <i class="fas fa-home"></i>
                 </button>
             </div>
         </div>
    </header>

    <!-- View Sections Container -->
    <div id="view-container">

        <!-- HOME VIEW -->
        <section id="home-content" class="view-section active">
            <div id="particles-js-container"></div> <!-- Particles Canvas -->
            <h1 class="main-title">The <span class="highlight-yellow">Unblocked</span> Zone</h1>
            <p class="slogan">Break free from the bounding chain</p>
            <div class="info-boxes">
                <div class="info-box"> <i class="fas fa-cloud"></i> <span class="info-title">Zero Downloads</span> <p class="description">Play instantly in your browser, no downloads or installations required.</p> </div>
                <div class="info-box"> <i class="fas fa-user-slash"></i> <span class="info-title">No Registration</span> <p class="description">Jump straight into the action without needing to sign up or log in.</p> </div>
                <div class="info-box"> <i class="fas fa-rocket"></i> <span class="info-title">Instant Play</span> <p class="description">Fast loading times mean less waiting and more gaming.</p> </div>
                <div class="info-box"> <i class="fas fa-shield-alt"></i> <span class="info-title">Network Bypass</span> <p class="description">Access your favorite games even on restricted school or work networks.</p> </div>
                <div class="info-box"> <i class="fas fa-mobile-alt"></i> <span class="info-title">Mobile Friendly</span> <p class="description">Enjoy many games on the go with responsive design for phones and tablets.</p> </div>
                <div class="info-box"> <i class="fas fa-sync-alt"></i> <span class="info-title">Always Updated</span> <p class="description">We regularly add new games and ensure existing ones are working.</p> </div>
            </div>
            <button id="launchButton" class="launch-button">Launch Games</button>
        </section>

        <!-- GAME GRID VIEW -->
       <section id="game-section" class="view-section">
           <h2>Select Your Game</h2>
           <div class="controls-container">
                <!-- NEW Search Bar -->
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="search" id="searchInput" placeholder="Search games...">
                </div>
                <!-- Existing Category Filters -->
                <div class="category-filters"> <button class="category-button active-category" data-filter="All">All</button> <button class="category-button rainbow-bg" data-filter="New">New</button> <button class="category-button" data-filter="Action">Action</button> <button class="category-button" data-filter="Arcade">Arcade</button> <button class="category-button" data-filter="Clicker">Clicker</button> <button class="category-button" data-filter="Driving">Driving</button> <button class="category-button" data-filter="Endless">Endless</button> <button class="category-button" data-filter="Flash">Flash</button> <button class="category-button" data-filter="Horror">Horror</button> <button class="category-button" data-filter="Multiplayer">Multiplayer</button> <button class="category-button" data-filter="Platformer">Platformer</button> <button class="category-button" data-filter="Puzzle">Puzzle</button> <button class="category-button" data-filter="Runner">Runner</button> <button class="category-button" data-filter="Physics">Physics</button> <button class="category-button" data-filter="Simulation">Simulation</button> <button class="category-button" data-filter="Sports">Sports</button> <button class="category-button" data-filter="Strategy">Strategy</button> <button class="category-button" data-filter="TowerDefense">Tower Defense</button> <button class="category-button" data-filter="3D">3D</button> <button class="category-button" data-filter="Skill">Skill</button> <button class="category-button" data-filter="io">io</button> <button class="category-button" data-filter="Sandbox">Sandbox</button> <button class="category-button" data-filter="Funny">Funny</button> <button class="category-button" data-filter="Maze">Maze</button> <button class="category-button" data-filter="Idle">Idle</button> <button class="category-button" data-filter="Rhythm">Rhythm</button> <button class="category-button" data-filter="Math">Math</button> <button class="category-button" data-filter="Classic">Classic</button> <button class="category-button" data-filter="Shooter">Shooter</button> <button class="category-button" data-filter="FPS">FPS</button> <button class="category-button" data-filter="Adventure">Adventure</button> </div>
                <!-- Existing Sort Dropdown -->
                <div class="sort-container"> <label for="sortOptions">Sort by:</label> <select id="sortOptions"> <option value="az" selected>A-Z</option> <option value="za">Z-A</option> </select> </div>
            </div>
            <div class="icon_image" id="icon_image">
                 <!-- REVIEW and ADJUST data-players: 1=Single, Multi=Multiplayer, 2=Strict 2-Player -->
                 <a data-game-url="https://www.mathsisfun.com/games/a/2048/index.html" data-game-creator="Gabriele Cirulli" class="game-link Puzzle Strategy" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7put38SVe1Deg0JqDmLg8HZ58mA0KmW_tYuMKUlfrCQ3SWkOLXT2lD_BSmRw-18BJMfC1FDl1L5wYd0FPxAzCgK1sDtczcyzJa1uTBSfeiv8QFz6N_0T9Js_Bved5T4tkMyn1nxqarw7Lp-ZSWriMLgjEd8VT87VgRuVRMeu67W4BuMCqGr?key=_cqGIZPHcS9nSvbhhzHuQw" alt="2048" loading="lazy"> <figcaption>2048</figcaption> </a>
                 <a data-game-url="https://suite.saltyspamz.xyz/games/games/9007199254740992/" data-game-creator="Constructible Universes" class="game-link Puzzle Strategy Math" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7pZz0gPYRzLFGc2CfRoFFmneCupdyhaZ27IkDDFgVSlpRLf4RGmirknfFphoJzZ_mrImVIOMz81Zr-1SvjW0yGRi-eiK0e-s-uiZn12I1_1dtoro4T6Nma7WpqNCKqiGtmS-mYHKD58MEjRobVxOV5rgWrR4pf3piW5gN_6X2VhaFCoeMB8?key=_cqGIZPHcS9nSvbhhzHuQw" alt="9007199254740992" loading="lazy"> <figcaption>9007199254740992</figcaption> </a>
                 <a data-game-url="https://asmallworldcup.com/embed/a-small-world-cup/" data-game-creator="Roody Games" class="game-link Sports Physics" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7riJk0hgmbjPFIWyDZ5-M_7RiRBgV9gGgPo1nrygI5GWkmVBZMFR1DS544OdB1xHSYhHEtWxtFq4i3-oRoKCtBJMsTmM2mpCKJPaZ8SsLyVIplMkHA3MfCqAEiVSTR2FIN3BuryTETBK8v8IezaunERekXJ1a8HeZgLOklB8DPbn57s8j3s?key=_cqGIZPHcS9nSvbhhzHuQw" alt="A Small World Cup" loading="lazy"> <figcaption>A Small World Cup</figcaption> </a>
                 <a data-game-url="https://reunbozdo.github.io/" data-game-creator="Puzzle Dev" class="game-link Puzzle" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qrr5y2BGA815sfSQkwY9HkFAH5G8xo20uonAjEze3DVIFpviSRVeCyax2QdrrscVNT2SiLld0pMkVrWmjnk2hwJstqAnrBCwNhjU8PWAtngdkVWh6rSVaRIrblM6Ho4KV7C2axBS9cUqVf1B8bEgBNP8pBzavHVXB4rcWuOIYfRfGXtdXf?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Block Blast" loading="lazy"> <figcaption>Block Blast</figcaption> </a>
                 <a data-game-url="https://html-classic.itch.zone/html/13185656/index.html" data-game-creator="Ninja Kiwi" class="game-link TowerDefense Strategy" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rQONyJLzuwSRLCx5pPS4VXlJz600WaXeQ4X9D3AtPxqcuCB3n0rz4nFb2G4ykyQ59fcyKw49iVqXx5H5xf83FXif1H6FN8ZxDYqIKvZeYIqhiUimt147JUBYoqYKq1sat1qN51Ps-D90AK8ZIKkE1c7ZSENKHGGVkTCwKXsIQAOi2NRx8?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Bloons TD 6" loading="lazy"> <figcaption>Bloons TD 6</figcaption> </a>
                 <a data-game-url="https://gas.education/gams/gfiles/html5/cookieclicker/" data-game-creator="Orteil" class="game-link Clicker Idle" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7pZl7t0nmYsHYi1x81A0hAoSPEgoNJdz8zt1iZuP6b2f4UOIclYI3v0sv9HYXz9KY9CFYswbcLoPD8ENy5zFQHgpa3iCQiAW4BSZIREl9xHAkiIMwXUrkYgsNTsbHFcRW-DYJsmGWY4MnPaLRSzsCC-hMSoIADorKLmc_jk-XW_FeqpKfWE?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Cookie Clicker" loading="lazy"> <figcaption>Cookie Clicker</figcaption> </a>
                 <a data-game-url="https://www.newgrounds.com/portal/view/812336?external=1" data-game-creator="CrazyCattle3D Devs" class="game-link Action 3D" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qZCHjKmw_w6YudN_-o2tdju7khQMGMJT9vopyn2lnfU1hXApGzZKYnsJIno-wIgNNyF7m_54CdTUsRZ8GJtftApvrvFAV9Gr_a-poi8H6E6yHq01imgpFq1sF-bwqhfmIhs2suHSJ_D-I3xbYHe4uetlhRESyhQPj-nxXmyJvVJVJZnDNV?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Crazy Cattle 3D" loading="lazy"> <figcaption>Crazy Cattle 3D</figcaption> </a>
                 <a data-game-url="https://i.gamesgo.net/uploads/game/html5/4072/" data-game-creator="Hipster Whale" class="game-link Arcade Endless" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rOweCQcfnn78ni750PKljtv4vIfBmxtDIdtyJFJ8CV_C6O3ejV6GEbcPqnY-zGsI8OymOXaxxfcYekMA5CVBAT4uUEXhwPUonRD4NoQIyHNXPTN1H6yqY8xgProGIlfzII8G7-_udplWZHsWZ4vLKdKJ1yH-XybGNZ6DQHGwrHiwihHjki?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Crossy Road" loading="lazy"> <figcaption>Crossy Road</figcaption> </a>
                 <a data-game-url="https://www.doodlescricket.com/#/" data-game-creator="Google" class="game-link Sports Arcade" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7q6FutmpDcRE7iP7pHpkcYHW1AXo4ysaVzskouBgVJhroaNGnjYyjCWezezk232ffG1alWFdMZsZHmQN3pQj2-M49RrjIaKb2SeCujsV3zEjmhmsEcnvxrpA9sPuxJHTW14MU-UXN-VicJuclf0SVszrgZWALWVW8S6pfMx-48RDO866Sy-?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Google Cricket" loading="lazy"> <figcaption>Google Cricket</figcaption> </a>
                 <a data-game-url="https://playcanv.as/index/DLgXf1zr" data-game-creator="Neal Agarwal" class="game-link Arcade Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7oWAHnijD3dp8BFC6ncGUfyHh8ohOscjD5wG691cabrW3sjjTSgv-RCFvY9QDvQ0FItKAZSEQb4YuvXgYzlwaxZd2X6DNkqbFrUqWn1Cb0awdBPEkMwmq52lsE9A6c31J9bcAKG8yRU6VwpBxz8Bg3ipUcSp-erFrpOu8lqpKqBZsN0VB55?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Flappy Bird" loading="lazy"> <figcaption>Flappy Bird</figcaption> </a>
                 <a data-game-url="https://run3.io/popgame/fnaf/fnaf1/" data-game-creator="Scott Cawthon" class="game-link Horror Survival" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qxsRqfRqTXYs7sxGuW_b8bPMp3MMULiBfpDb8n9iasl8M6ITdi-MW5JMyYC0o9O_uboNa-y4qIQlMn03qOmbao6pPVbm-Hb5QAc0hX4i-v-pQF9xz8uH2w4jfBCRo1q7a25xr-TCpjAyGoDmSafeXHoZUfrT9_Wn5AqDdgV7cMop7pi9oC?key=_cqGIZPHcS9nSvbhhzHuQw" alt="FNAF 1" loading="lazy"> <figcaption>FNAF 1</figcaption> </a>
                 <a data-game-url="https://run3.io/popgame/fnaf/fnaf2.html" data-game-creator="Scott Cawthon" class="game-link Horror Survival" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7o6scntWzvbNfuHXk8uu1pH_YbHOBw6ds4ITknP0bwNJmPWkD2qF2tubjnbpwnHOG1zFGIRBc2DOyS2iU4GyuHDqZblXJl5SqsTtibCIbKl3JAMffa2WddCRQfEfUTE_kX6zv4Aarympzm0949cxnX-Mhzz4bs-vSlHHQg0XcuJwvyMuv4?key=_cqGIZPHcS9nSvbhhzHuQw" alt="FNAF 2" loading="lazy"> <figcaption>FNAF 2</figcaption> </a>
                 <a data-game-url="https://run3.io/popgame/fnaf/fnaf3.html" data-game-creator="Scott Cawthon" class="game-link Horror Survival" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qUdr9O8tYfMzPwYk3z6S1ets56fqkoQkIt0QmqUQ9JKSicXhUvDujDd1v-0rR9Qyt1jXp78oXAKczijMvQbCSdxkbOr7wV0VKDkG8m37rplmajZsAOKQwnY_xWVannmJeW9Yv4WRovZI0ThJ2dB7uXxi6g7PzVVAJ9C5dbGlTyyGWsh_J5?key=_cqGIZPHcS9nSvbhhzHuQw" alt="FNAF 3" loading="lazy"> <figcaption>FNAF 3</figcaption> </a>
                 <a data-game-url="https://run3.io/popgame/fnaf/fnaf4.html" data-game-creator="Scott Cawthon" class="game-link Horror Survival" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7ocfBjnIr8FZzzBVwQmSFToA1GSsRxCzfaosFibKbByEpsKKx2RvNu0QMbunPkGqUsVaIOUXB8ScC0fs06SG3JfDZ7XHGjWkRYgq6WzttuXX-dJamW-I0UMB9M6AdmWdvZi3a7DIsw72RlBfC5lR7YMoH5MV3SFmjDLIqnEYHufQBetb7_n?key=_cqGIZPHcS9nSvbhhzHuQw" alt="FNAF 4" loading="lazy"> <figcaption>FNAF 4</figcaption> </a>
                 <a data-game-url="https://run3.io/popgame/fnaf/fnafsl.html" data-game-creator="Scott Cawthon" class="game-link Horror Survival" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7oDEeqHYA5Pd5F6ylFWd2fcI_Kg2YOTbPYfbOoczerUGf5JYcSMPhLvfS_e0Paw4jZsGA85KKzBt8qP-rkCYKJ7cpQexYHLARWRO-wzO8DN2YoRVJPz1R1BanRLn8-2-yzkPeIlS7_VVUYK49hoUlbDhFDbiA1fLiX3HqfJjoLK-XoYfXJc?key=_cqGIZPHcS9nSvbhhzHuQw" alt="FNAF Sister Location" loading="lazy"> <figcaption>FNAF Sister Location</figcaption> </a>
                 <a data-game-url="https://ubg365.github.io/fruit-ninja/" data-game-creator="Halfbrick Studios" class="game-link Arcade Action Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rSQqThTWWv3mGPKYjKGvcJGwq8smg0uzsqqAI4Qb3pB45Lo5Js6Msyp1ElwqaSQ9kcwGr7xJnBAdxZDmSScQ9zfm1R2VsFpIptQOgz5QnsQ7abILhYYsh3LnNZS4iOEe4Sc-xrq3iBiyj6qHpzcGIO62MebNvQscrPVRN05bOjnOQQ2ABF?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Fruit Ninja" loading="lazy"> <figcaption>Fruit Ninja</figcaption> </a>
                 <a data-game-url="https://geometrygame.org/game/geometry-dash-lite/" data-game-creator="RobTop Games" class="game-link Platformer Arcade Rhythm" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7r84NgcBmdPNZFCxNZ8TyMhAeh8RB7MB4wLFA4tsjEcBAgD3pb-9DKawHgvUwPKogqlN7jCm7wihV4PiCQcE-EJgw2vghN_MENnuaUAB7Oj39KS0YyM5CSRwEr62_XbGCc4Wg6Tvr4F-wXOglG9-SA0IdzXrE4ALGF61c-ltn-lP0ezSCvw?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Geometry Dash" loading="lazy"> <figcaption>Geometry Dash</figcaption> </a>
                 <a data-game-url="https://iron-snout.gitlab.io/file/" data-game-creator="SnoutUp" class="game-link Action Fighting" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rFlYf0z0lM9mfibdSziu7uP1F6HsGy-GaknU5oY8duR-gOJQLHlP2vj5oDy3YimYxT_ENdfVVwtBMKkywWN2ngZ8QEwRXaUxpwOP6D9D6FqGZigeXZW8mus2OQ_oLKb_4nOokUBrDLv1DViqNat_qOKzwhevT1WdG7OyYZ7IBv8sHdvCHu?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Iron Snout" loading="lazy"> <figcaption>Iron Snout</figcaption> </a>
                 <a data-game-url="https://ext.minijuegosgratis.com/jetpack-joyride/index.html" data-game-creator="Halfbrick Studios" class="game-link Arcade Endless Action Runner" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rTBZHw6BTCcf7wLeFm_M4snJMR8b5LgbbBaYmULeubUuBwko6OBb4T00sgQGTqk0EHcWvXqv9HKHyN8_yVT8RXrNXi94TWirscS7LtioGfMnoUmyC7dAlETpv6cH02CAYv5GVB3brQTdco9wBKAyeWz4CLN4KRfUEwuQKd4FPh60B6bgYP?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Jetpack Joyride" loading="lazy"> <figcaption>Jetpack Joyride</figcaption> </a>
                 <a data-game-url="https://rbeesley.github.io/MicrosoftEdge-SURF/" data-game-creator="Microsoft" class="game-link Arcade Endless Sports" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7ooD61sLts6Iw2em1eMWkXX0rSHMyqMpF6m8zhqjfQxD8wF4V85UimeRJQHCliWfh66WTYDGuDBhF4WuYiRKq8XQ8lt210vidWAStA7HvSDhUUn-rlwgLRMM5_znewZajJKED4yW25OdviEY4OqLeuhS8ww3KIBgmLf6GgowhnWuUv0?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Let's Surf" loading="lazy"> <figcaption>Let's Surf</figcaption> </a>
                 <a data-game-url="https://www.echalk.co.uk/amusements/Games/Pacman/pacman.html" data-game-creator="Bandai Namco" class="game-link Arcade Classic Maze Flash" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7r-5i4rsjjqfkWd2Cp88-WtShq9uBBWi8Ku_R2cEUyvDmSeLlwLuFP3x_xLn2OfmRUubvFhuc0OfqV26Gl4QLaL0mXXCULeE_WJP0Fe5KtKd076C3jiclAFVp5KQrmwQnelCBUjqXUSMHw7BQrAQNpW7bP6qUKy2VkHCOTSe1lH_t-kFi8A?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Pacman" loading="lazy"> <figcaption>Pacman</figcaption> </a>
                 <a data-game-url="https://pinball.flutter.dev/#/" data-game-creator="Google" class="game-link Arcade Simulation" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7ok4o3Bc0dQJfiX1acq0roG6aIeJWZ_Hb5iVj5T1GDha2sWklJ_19zIas29gHG_D_YfKG2Hxgg8EmqTSRDVhYvNHBr8jf-ws4vMHipvvfne-2CKDJXWWBzj3Ib-FiKK1whmFQUfkFK5jcI0O0VXNncbsBikW-ugQgvO123tGzA7P5WjouJT?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Google Pinball" loading="lazy"> <figcaption>Google Pinball</figcaption> </a>
                 <a data-game-url="https://basic-ruffle-player.vercel.app/html/polytrack/index.html" data-game-creator="Unknown" class="game-link Driving Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qx0hLvolDnX2W9Q_Usg-LUG3pcPT5y_hsIke7YhBOUhZYP0sHZzMTunNY83NzvH6h2RqJa4NUjgdHG8JTL4r_s5OawyrYJeJUkI1nPEd-Voc5Pu2d0ETyrJ2oPS2uIC9PY9MkWeF30I2prksM2GCwaa4N_j32jN-Gas36rbwciCCG9Q_4?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Poly Track" loading="lazy"> <figcaption>Poly Track</figcaption> </a>
                 <a data-game-url="https://thepizzaedition.github.io/JetpackJoyride/projects/portalflash/index.html" data-game-creator="We Create Stuff" class="game-link Puzzle Platformer Flash" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7p-gRkEDHVugliLG1jIBTbQ7es1njVrggnEdBRCz-gHNTGyIQeBa_hQifuQy7LhzHBlmNaxTL06uphva-vb_dxZKW7mEUxdHgdbhvQU8RbLi4K9VshuQNT3wO2ZSyEK6ySDbg7pmV04uH2hq9nZ-Vo7h2F8nuE_sbZ77O-UZ8XUFmYOtQMV?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Portal: The Flash Edition" loading="lazy"> <figcaption>Portal</figcaption> </a>
                 <a data-game-url="https://crackstuff.pages.dev/games/Rocket-League/" data-game-creator="Psyonix" class="game-link Sports Action Driving Multiplayer" data-players="Multi"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rYjGQcutZiOP7kIs8uzPqu6j5EJLBKv_m0kARbulGQStq5sivxMaEVJs08ymtn-xmL_2guPsC5vA6JRiWHobOaIItPR3x0TQ12u15sJ0qa4VSXP3i1BdgabRDWt6waOhWKnzqcID9rlqi_Upku7ZXJNMFktuzfsGK3o0dqWWwTlEuMAygY?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Rocket League Sideswipe" loading="lazy"> <figcaption>Rocket League</figcaption> </a>
                 <a data-game-url="https://linh879.github.io/run333/tn6pS9dCf37xAhkJv/" data-game-creator="Player03" class="game-link Endless Platformer Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7r5DJ8wEakDCWypgROGowJMDddkNaQ1jp6GHMiY_1yRFVrv020L5l7OotqzCtZJbUbYsNrYTv8SU6Qn45GsoEFFXmd-6rME7nsNhzRkiMAQfs9ssEec0UGMlJiHMVN1PBOb0SRf5c8c1xmqKMpLzpqxm2t9U49n1U-JjWfAgVhWWfRPcb2V?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Run 3" loading="lazy"> <figcaption>Run 3</figcaption> </a>
                 <a data-game-url="https://shalbito.vercel.app/" data-game-creator="R74n" class="game-link Simulation Sandbox Puzzle" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7q5k22Cyd3PRlgkWvTF0LZ74sdC57cTyjTXwW3OqjCDvFkIK-7E4yqqDXHGo6Egm5TBi_eOtqg_KBLSgOOCtIZ7hPTNkSZ4-lsSFkkNVZr_jkQ4v3pFNKtV_HNc17nkGltN4GsjEfwSPl8B_iVLZ9BOtP7xciE7-s2g8Wy1Pxl0PcU2ukw?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Sandboxels" loading="lazy"> <figcaption>Sandboxels</figcaption> </a>
                 <a data-game-url="https://shellshock.io/" data-game-creator="Blue Wizard Digital" class="game-link Action FPS Multiplayer io" data-players="Multi"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7oawJnFVM9CHI0haxijICQHcBTWP-DesKDkRCRpiQaNtAgXPLmzAFEKLWW-Vn8uPmNsfYjOOnasmiAxwm6BOttgNpEXiXPw9AcgeXhGTh2-ltExLPd685UNGBmfEay2XAUMNQQTb97DqhVGnm-QWB2eIVoJ0iyAcZu4zCc2S1EMUNVorIs?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Shellshock.io" loading="lazy"> <figcaption>Shellshock.io</figcaption> </a>
                 <a data-game-url="https://azgames.io/game/slope/" data-game-creator="Y8/Rob Kay" class="game-link Endless Skill Platformer 3D" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7ruFeRu_NYYJobl2iyufAhfnE3_OZhj8B523Qdb6fqB_AteU-AP3dwVqV__Wt6eOHTy_ZCYtCTHrSULqPOZSLaYPxdHwPI-4eGU3dvct8MuLRnuBa_Gy2iFJKrkEKRHPWBDwIKMjjkA4yLN_ntOnDRGz3BLR0RqNRS5F6IDIEp9Dv60PaMd?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Slope" loading="lazy"> <figcaption>Slope</figcaption> </a>
                 <a data-game-url="https://snake.io/crazygames/" data-game-creator="Kooapps Games" class="game-link Arcade Multiplayer io" data-players="Multi"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7qtZwR0uAOBsDgNPm27qqC15awQXfiDeFArEWgar66wd_PkonNyfyJVWzkFzedkf_-jwBBucEqUMUnEdQraziT5m2RBL_TxIipmVPnwDzvpgN6R1fY6iRIjKj-_Vo3DgLFAv_t-xKIVBPkiCb0TP1JAY7AqkPtzy5ZPWabAs9TbyglagulV?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Snake.io" loading="lazy"> <figcaption>Snake.io</figcaption> </a>
                 <a data-game-url="https://lagged.com/api/play2/spiral-roll3/" data-game-creator="Voodoo" class="game-link Arcade Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7oA1xAplYUBwiEV9tdnQfDJrnPJsGDtPgUQvs2nXCjFRgbKiAqfr_Ep5gDYe2Em7SvFM6aMVR9DL5HqDiNnvBgE1zs2fg7lA3XZYIcXmGV-AzOKrKRZ1IFx9GG0X_Y1Mq73jnDG3WYLcLkAFLF_LNAx-a2KtrpXeU_ENKVhVix1NizQpWqZ?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Spiral Roll" loading="lazy"> <figcaption>Spiral Roll</figcaption> </a>
                 <a data-game-url="https://jiwjfowhfusfdgfigiydgsifygdiyfgdi.netlify.app/games/stickmanhook/" data-game-creator="Madbox" class="game-link Arcade Skill Platformer" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7q2tuzgCTCvT0DgCavArC8IBUFSh7TusPVOUWpgzdQchZVh0wDYyJ1UvTlyNLqwR1eHCNqHxC7H1gHNHSgTHT3X6SwZE5Rn0iNZ4-Goy1uZDzUgJQI6xRBjLJstQ5DFz3A2iPLd-Sz_Yzy5IWgYgNixl8rehYQU6zyPjJkctZ-1CTAlmDHQ?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Stickman Hook" loading="lazy"> <figcaption>Stickman Hook</figcaption> </a>
                 <a data-game-url="https://g.igroutka.ru/games/164/ZXLa594fek6p7nVR/10/subway_surfers_classic/" data-game-creator="SYBO/Kiloo" class="game-link Endless Action Runner" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7oJIsfHHTpbUCkoZp6jvbH0DZkqNQLC7U73QEedljFzGQRdTCH_0Elmwfhm6uESB4H34jxq82hOILTR7cJiCN_lgS6y5XWKOdrxCeoBe5O_MwMvP2L3x7EmNfxbJdlFLFfote4m7qogW32p16GZYmrTP22zUb75JsTSG5E6OXsYAuZyfCw5?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Subway Surfers" loading="lazy"> <figcaption>Subway Surfers</figcaption> </a>
                 <a data-game-url="https://azgames.io/game/temple-run-2/" data-game-creator="Imangi Studios" class="game-link Endless Action Runner" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7pQBbWUS3X4kQ5ONbQVWfQeHyMoVnG9NvG1Q3Q6wGXoNNPgOe64MrZiDb2HDYYmscAIS_RLCPC4YWGwbqh8p3XLXoaE1w-c2JGU2DHZJwEI5k-odNID_eOwA9NYOjnffwlI2eB8JRLXIqFUxPbDfowAomu6KkW9uOdBPRhodrAryEoQpTnq?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Temple Run 2" loading="lazy"> <figcaption>Temple Run 2</figcaption> </a>
                 <a data-game-url="https://the-impossible-quiz.game-files.crazygames.com/ruffle/theimpossiblequiz.html?v=1.328" data-game-creator="Splapp-me-do" class="game-link Puzzle Flash Funny" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rBn1tq2QDIvM6w7D3HCGvhgrNVQOrrJMZIedz21QaMja3j1R-qicxQ-nA0fP_ueq7YewLEJEpha5568WkZqg6V1AmTQ50UIQN1jpIx8oonaA8flkDCeqI2weBNZzh6WWKqvhhYQppl7aUzL15aU_9XAedUeGwEwzulqBVjG-k2zbOwQ9uZ?key=_cqGIZPHcS9nSvbhhzHuQw" alt="The Impossible Quiz" loading="lazy"> <figcaption>The Impossible Quiz</figcaption> </a>
                 <a data-game-url="https://basic-ruffle-player.vercel.app/?file=TheImpossibleQuiz2.swf" data-game-creator="Splapp-me-do" class="game-link Puzzle Flash Funny" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7p2e5By6se7f4HZQSQ0d3qi6AGvVvxEsKVfoMrIGUbV8oBOb1yWCr0Po3c_jrPd8CWH_DZcNhH2LCWrOMlfyvWjgq-9OjJ0yFSssZvuEWIdGS_SdrK3OcSx6P57sKPaOT4pAG-0qH_iQ6GP7gzBiGEqjp4uD3cJ8XYCPSi2L9bc6G31bW1f?key=_cqGIZPHcS9nSvbhhzHuQw" alt="The Impossible Quiz 2" loading="lazy"> <figcaption>The Impossible Quiz 2</figcaption> </a>
                 <a data-game-url="https://slope-game.github.io/new5923/tomb/" data-game-creator="Playgendary" class="game-link Arcade Maze Skill" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7ozzlud4cjKkaKjci8i9152VGO2ffO8QIO_1u6S2gCO-vqEhFDGLAfR7rjb-GHh_BjQhRXwj4AOByOfWmzrkOncsi4u56rwg3ryiZsJaHbujOFkY_nLcHqwNUEkGmiY_4GvYUG5ljLJN3nCI2NgyDj0vlh8DsAn9imul8uN6VTA--R4C59i?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Tomb Of The Mask" loading="lazy"> <figcaption>Tomb Of The Mask</figcaption> </a>
                 <a data-game-url="https://slope-game.github.io/rungame/tunnel-rush-2/" data-game-creator="Deer Cat Games" class="game-link Endless Skill 3D" data-players="1"> <img src="https://lh7-rt.googleusercontent.com/sitesz/AClOY7rTWc-IpLPXKE28ixI-sHuWA4Xpw8fQeq3_iwbhhDvprD85bYgMd1Hl1uwcLWKkoikVqO4DFZ9ym2ZUpTfJCNgF3Jmzvflob23-wLCQ43k6Q7r6nO7dFMd3dhYRiBGIe3vmqmZax-Y1O7o7RFT6dxx9w1tf9vsGi1UooVEr-Crw-bgLAc2P?key=_cqGIZPHcS9nSvbhhzHuQw" alt="Tunnel Rush 2" loading="lazy"> <figcaption>Tunnel Rush 2</figcaption> </a>

                 <!-- New Games (Added with 'New' class, updated/fixed icons) -->
                 <a data-game-url="https://1000mines.com/" data-game-creator="Classic / 1000Mines" class="game-link Puzzle Strategy Classic New" data-players="1"> <img src="https://styles.redditmedia.com/t5_2r4c3/styles/communityIcon_whz4tmbb4w061.png" alt="Minesweeper" loading="lazy"> <figcaption>Minesweeper</figcaption> </a>
                 <a data-game-url="https://smashkarts.io/" data-game-creator="Tall Team" class="game-link Action Driving Multiplayer io 3D New" data-players="Multi"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/9c9e529b14731be871b07b89660bbc2a.png" alt="Smash Karts" loading="lazy"> <figcaption>Smash Karts</figcaption> </a>
                 <a data-game-url="https://cryzen.io/play" data-game-creator="Cryzen Team" class="game-link Action FPS Multiplayer io 3D Shooter New" data-players="Multi"> <img src="https://imgs.search.brave.com/S2rOYG8AWcBvtR5PZqvp4yh0zYyz0ujjC53S9p8iB4E/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9jZG4u/bm93LmdnL2FwcHMt/Y29udGVudC9jb20u/bm93Z2cuaDUucHVi/NzA0LmFwcDUxNTQx/L2ljb24vY3J5emVu/LWlvLnBuZw" alt="Cryzen.io" loading="lazy"> <figcaption>Cryzen.io</figcaption> </a> <!-- Updated -->
                 <a data-game-url="https://venge.io/" data-game-creator="OnRush Studio" class="game-link Action FPS Multiplayer io 3D Shooter New" data-players="Multi"> <img src="https://imgs.search.brave.com/hb8f1lTIxqQqIPyFGLBD-a7DHZ0mAj6ZodMD5kVzso0/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9jZG4t/MS53ZWJjYXRhbG9n/LmlvL2NhdGFsb2cv/dmVuZ2UtaW8vdmVu/Z2UtaW8taWNvbi1m/aWxsZWQtMjU2LnBu/Zz92PTE3MTQ3NzYz/NDE0MjI" alt="Venge.io" loading="lazy"> <figcaption>Venge.io</figcaption> </a> <!-- Updated -->
                 <a data-game-url="https://sandstrike.io/" data-game-creator="Smusi Games" class="game-link Action FPS Multiplayer io 3D Shooter New" data-players="Multi"> <img src="https://imgs.search.brave.com/O_5Lod-kaa82UiDIqldD4yT3qjoHRD40pSGwNFDyoqQ/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9yb2Nr/ZXRnYW1lcy5pbWdp/eC5uZXQvdXBsb2Fk/cy9nYW1lcy9zL3Nh/bmRzdHJpa2UtaW8v/c2FuZHN0cmlrZS1p/by5qcGc_YXV0bz1m/b3JtYXQsY29tcHJl/c3MsZW5oYW5jZSZ3/PTIwNCZkcHI9MQ" alt="Sandstrike.io" loading="lazy"> <figcaption>Sandstrike.io</figcaption> </a> <!-- Updated -->
                 <a data-game-url="https://ev.io/" data-game-creator="Addicting Games Inc." class="game-link Action FPS Multiplayer io 3D Shooter New" data-players="Multi"> <img src="https://play-lh.googleusercontent.com/juxYvgqg-LoPrQrLW3M6xRrPlZD-k_Dms6xmzG0GJf5RhDK0fXtyAtmLRLVzHe2AQ32l=s956-rw" alt="Ev.io" loading="lazy"> <figcaption>Ev.io</figcaption> </a>
                 <a data-game-url="https://driftboss-online.github.io/file/" data-game-creator="MarketJS / Unknown" class="game-link Driving Skill Arcade Endless New" data-players="1"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/baf55f009fd63dd63c760a5dcfe79615.png" alt="Drift Boss" loading="lazy"> <figcaption>Drift Boss</figcaption> </a>
                 <a data-game-url="https://html5.gamedistribution.com/rvvASMiM/ac6a950a44d144139dabe7837aa4aab9/index.html?gd_sdk_referrer_url=https%3A%2F%2Felifesimulation.io%2Fbitlife&gd_zone_config=eyJwYXJlbnRVUkwiOiJodHRwczovL2VsaWZlc2ltdWxhdGlvbi5pby9iaXRsaWZlIiwicGFyZW50RG9tYWluIjoiZWxpZmVzaW11bGF0aW9uLmlvIiwidG9wRG9tYWluIjoiZWxpZmVzaW11bGF0aW9uLmlvIiwiaGFzSW1wcmVzc2lvbiI6ZmFsc2UsImxvYWRlckVuYWJsZWQiOnRydWUsImhvc3QiOiJodG1sNS5nYW1lZGlzdHJpYnV0aW9uLmNvbSIsInZlcnNpb24iOiIxLjUuMTcifQ%253D%253D" data-game-creator="Candywriter" class="game-link Simulation Idle Funny New" data-players="1"> <img src="https://play-lh.googleusercontent.com/3_pJXihjGNygcDUyyUiKHObSE-LiNcM5iPWWvFDzI2IG09D4eZZ3EQzMcFSDm8P568w=w240-h480-rw" alt="BitLife" loading="lazy"> <figcaption>BitLife</figcaption> </a>
                 <a data-game-url="https://www.coolmathgames.com/0-push-your-luck/play" data-game-creator="Coolmath Games" class="game-link Puzzle Strategy Math Skill New" data-players="1"> <img src="https://www.coolmathgames.com/sites/default/files/styles/app_icon/public/push-your-luck-game-icon.png?itok=aeT8A2NP" alt="Push Your Luck" loading="lazy"> <figcaption>Push Your Luck</figcaption> </a> <!-- Updated -->
                 <a data-game-url="https://ducklifegame.io/gg/duck-life-9/" data-game-creator="Cheetah Games" class="game-link Arcade Skill Runner New" data-players="1"> <img src="https://img.tapimg.net/market/images/0037ae1dba5b6c6264e48492b604ac13.png/appicon_m?t=1" alt="Tap Tap Dash" loading="lazy"> <figcaption>Tap Tap Dash</figcaption> </a>
                 <a data-game-url="https://kdata1.com/2020/05/22948/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/d0048d89-e4fa-4adb-9c77-adc51e4e1c6b.png" alt="Duck Life" loading="lazy"> <figcaption>Duck Life</figcaption> </a>
                 <a data-game-url="https://kdata1.com/2019/09/ducklife2/webgl/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/f2431276-8a98-4214-9a88-d0ea91fe0af2.png" alt="Duck Life 2" loading="lazy"> <figcaption>Duck Life 2</figcaption> </a>
                 <a data-game-url="https://kdata1.com/2019/09/ducklife3/webgl/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/f5671816-e95b-4d41-adb7-411708f431ba.png" alt="Duck Life 3" loading="lazy"> <figcaption>Duck Life 3</figcaption> </a>
                 <a data-game-url="https://kdata1.com/2020/05/22948/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://img.poki.com/cdn-cgi/image/quality=78,width=204,height=204,fit=cover,f=auto/e0453c83-9012-44a3-8d4d-595ea0400f58.png" alt="Duck Life 4" loading="lazy"> <figcaption>Duck Life 4</figcaption> </a>
                 <a data-game-url="https://n-src66thyd5u5fsjmgyioulc37nhbtahadirzvky-0lu-script.googleusercontent.com/userCodeAppPanel" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://imgs.search.brave.com/yGRkGT4cALvpFmae-x67frkAEfGHYLlW51DbblvsuL8/rs:fit:200:200:1:0/g:ce/aHR0cHM6Ly9kdWNr/bGlmZS5vbmxpbmUv/dXBsb2FkL2ltZ3Mv/ZHVjay1saWZlLXRy/ZWFzdXJlLWh1bnQu/anBn" alt="Duck Life 5" loading="lazy"> <figcaption>Duck Life 5</figcaption> </a> <!-- Updated Icon -->
                 <a data-game-url="https://games.wixgames.co.uk/games/ducklifespace/webgl/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny New" data-players="1"> <img src="https://play-lh.googleusercontent.com/ndILnpPIPE5Kfqmwzjlbdz2duHMjh0yvnZ31PBJ_-oZOPa9iYfh1jedpj2-td2pyrKmj=w240-h480-rw" alt="Duck Life 6: Space" loading="lazy"> <figcaption>Duck Life: Space</figcaption> </a>
                 <a data-game-url="https://games.wixgames.co.uk/games/ducklifebattledemo/webgl/" data-game-creator="Wix Games / 5Games" class="game-link Simulation Sports Arcade Skill Funny Action New" data-players="1"> <img src="https://imgs.search.brave.com/shlrreksc8OZ3h_ymxtJrD5zbXLBd_s0JV_XcP2v_KE/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9pbWdz/LnNlYXJjaC5icmF2/ZS5jb20vR2g0dndZ/S3FvU0JhcmprSkM4/LTVldGVrZmo5ZldW/OU5PWGY2NlA2QjNV/WS9yczpmaXQ6NTYw/OjMyMDoxOjAvZzpj/ZS9hSFIwY0hNNkx5/OW5ZVzFsL2N5NTNh/WGhuWVcxbGN5NWov/Ynk1MWF5OW5ZVzFs/Y3k5ay9kV05yYkds/bVpXSmhkSFJzL1pT/OXBZMjl1TG5CdVp3.jpeg" alt="Duck Life 7: Battle (Demo)" loading="lazy"> <figcaption>Duck Life: Battle (Demo)</figcaption> </a> <!-- Updated Icon -->
             </div>
             <p id="noGamesMessage" style="display: none; color: var(--secondary-blue); margin-top: 30px; width: 100%; text-align: center;"></p>
        </section>

        <!-- Game Player Section -->
       <section id="game-player-section" class="view-section">
            <div class="game-player-box">
                <div class="iframe-container">
                    <iframe id="gameFrame" src="about:blank" allow="fullscreen; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" frameborder="0"></iframe>
                     Your browser does not support iframes.
               </div>
                <div class="game-footer">
                   <div class="game-info">
                        <span id="currentGameTitle">Game Title</span>
                        <span id="currentGameCreator">Creator</span>
                   </div>
                    <div class="game-controls">
                        <button id="backButton" title="Back to Games"><i class="fas fa-arrow-left"></i></button>
                       <button id="fullscreenButton" title="Toggle Fullscreen"><i class="fas fa-expand"></i></button>
                   </div>
                </div>
            </div>
        </section>

       <!-- HELP VIEW (NEW - Button Based with Popup Form) -->
       <section id="help-section" class="view-section">
           <h2 style="color: var(--accent-color); font-family: 'Orbitron', sans-serif; margin-bottom: 40px;">Help & Support</h2>

           <p style="color: var(--secondary-blue); max-width: 700px; text-align: center; line-height: 1.6; margin-bottom: 50px;">
               Need assistance or have an idea? Choose an option below. Submissions are sent directly to the site administrators.
           </p>

           <!-- Big Buttons Container -->
           <div class="help-options-container">
               <a href="#" id="requestGameBtn" class="help-button animated-button">
                   <i class="fas fa-gamepad"></i>
                   <span>Request a Game</span>
                   <small>Suggest a new game to add</small>
               </a>
               <a href="#" id="reportIssueBtn" class="help-button animated-button">
                   <i class="fas fa-bug"></i>
                   <span>Report an Issue</span>
                   <small>Report broken games or site bugs</small>
               </a>
               <!-- Add more buttons here if needed -->
           </div>
       </section>

        <!-- SUGGESTIONS VIEW (Finder is inside this) -->
        <section id="suggestions-section" class="view-section">
            <h2>Game Suggestions</h2> <!-- Title style applied via CSS -->

             <!-- Step 1: Player Count -->
             <div id="player-count-step" class="finder-step active-step">
                 <h3><i class="fas fa-users"></i> How many players?</h3>
                 <div class="step-options-container player-count-options">
                    <a href="#" class="step-button" data-players="1">
                        <i class="fas fa-user"></i>
                        <span>1 Player</span>
                        <small>Play solo</small>
                    </a>
                    <a href="#" class="step-button" data-players="2">
                        <i class="fas fa-user-friends"></i>
                        <span>2 Players</span>
                        <small>Play with a friend</small>
                    </a>
                     <a href="#" class="step-button" data-players="3+"> <!-- Changed "3" to "3+" -->
                         <i class="fas fa-globe"></i>
                         <span>3+ Players</span>
                         <small>Group/Multiplayer</small>
                     </a>
                 </div>
             </div>

            <!-- Step 2: Category -->
            <div id="category-select-step" class="finder-step">
                <h3><i class="fas fa-tags"></i> What kind of game?</h3>
                  <div class="category-filters finder-categories">
                      <button class="category-button active-category" data-filter="Any">Any Category</button> <!-- Default active -->
                       <!-- Categories will be copied here by JS -->
                   </div>
             </div>

             <!-- Step 3: Results -->
              <div id="results-step" class="finder-step">
                 <h3><i class="fas fa-poll"></i> Here are some suggestions:</h3>
                  <div id="finder-results-container">
                      <!-- Results will be populated here by JS -->
                       <p id="finderNoResults" style="display: none; color: var(--secondary-blue); margin-top: 30px; width: 100%; text-align: center;">No games found matching your criteria.</p>
                  </div>
                  <button id="restartFinderBtn" class="settings-button" style="margin-top: 30px;">Search Again</button>
             </div>

        </section>

        <!-- ADMIN VIEW (NEW) -->
       <section id="admin-section" class="view-section">
           <h2>Admin Panel</h2> <!-- Title style applied via CSS -->
           <p style="color: var(--secondary-blue); margin-bottom: 30px;">Site overview and management tools.</p>

            <!-- ===== Admin Dashboard ===== -->
            <div id="admin-dashboard">
                <div id="admin-stats">
                    <h3>Site Statistics</h3>
                    <div class="stat-item">
                        <span class="stat-label"><i class="fas fa-gamepad"></i> Total Games:</span>
                        <span class="stat-value" id="stat-total-games">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label"><i class="fas fa-tags"></i> Total Categories:</span>
                        <span class="stat-value" id="stat-total-categories">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label"><i class="fas fa-exclamation-triangle"></i> Games with Errors:</span>
                        <span class="stat-value" id="stat-games-with-errors">--</span>
                        <small>(Run "Test All Games")</small>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label"><i class="fas fa-envelope"></i> Total Submissions:</span>
                        <span class="stat-value" id="stat-total-submissions">--</span>
                        <small>(Requires Backend/Fetch)</small> <!-- Updated small text -->
                    </div>
                    <!-- Add more stats here as needed -->
                </div>
                <div id="admin-chart-container">
                    <h3>Games by Category</h3>
                    <canvas id="categoryChartCanvas"></canvas>
                </div>
            </div>
            <!-- ============================== -->

            <!-- ===== Game Manager ===== -->
            <div id="admin-game-manager">
                <h3>Game Management</h3>
                <div id="game-manager-controls" style="margin-bottom: 15px;">
                    <!-- Add New Game button can go here later -->
                    <span id="game-manager-status" style="font-size: 0.8rem; color: var(--description-color);">Edits are temporary (session only).</span>
                </div>
                <div class="game-manager-table-container">
                    <table id="game-manager-table">
                        <thead>
                            <tr>
                                <th>Icon</th>
                                <th>Title</th>
                                <th>Creator</th>
                                <th>Categories</th>
                                <th>Players</th>
                                <th>URL</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="game-manager-table-body"> <!-- Added ID -->
                            <!-- Game rows will be populated by JS -->
                            <tr><td colspan="7" style="text-align:center; padding: 20px;">Loading games...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- =========================== -->


           <div class="admin-actions"> <!-- Actions like Test Button are now below manager -->
               <button id="testAllGamesBtn" class="settings-button">Test All Game Links</button>
               <div id="gameTestResults">
                   <!-- Test results will appear here -->
               </div>
           </div>
       </section>


    </div> <!-- End of view-container -->

    <!-- Settings Popup Structure -->
    <div id="settingsOverlay" class="settings-overlay"></div>
    <div id="settingsPopup" class="settings-popup">
        <div class="settings-header">
            <h2 class="settings-title">Settings</h2>
            <button id="closeSettingsButton" class="header-button" title="Close Settings">&times;</button>
        </div>
        <div class="settings-content">
            <div class="settings-section">
                <h3>Tab Cloak</h3>
                <div id="tabCloakOptions" class="tab-cloak-options">
                    <!-- Options dynamically added by JS -->
                </div>
            </div>
        </div>
        <div class="settings-actions">
            <button id="resetCloakButton" class="settings-button">Reset to Default</button>
            <button id="applyCloakButton" class="settings-button">Apply Cloak</button>
        </div>
    </div>

     <!-- Support Form Popup Structure (Hidden by default) -->
    <div id="supportFormOverlay" class="settings-overlay"></div> <!-- Re-use settings overlay style -->
    <div id="supportFormPopup" class="settings-popup"> <!-- Re-use settings popup style -->
        <div class="settings-header">
            <h2 id="supportFormTitle" class="settings-title">Submit Request</h2> <!-- Title is dynamic -->
            <button id="closeSupportFormBtn" class="header-button" title="Close Form">&times;</button>
        </div>
        <div class="settings-content">
            <!-- The actual form -->
            <form id="supportForm" style="text-align: left;">
                <input type="hidden" id="supportType" name="supportType" value=""> <!-- Stores "Game Request" or "Issue Report" -->

                <!-- Common Fields -->
                <div style="margin-bottom: 15px;">
                    <label for="supportTopic" id="topicLabel">Topic:</label>
                    <input type="text" id="supportTopic" name="topic" required placeholder="e.g., Issue with Slope Game" />
                </div>

                <!-- Fields ONLY for Game Request -->
                <div id="gameRequestFields" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label for="gameUrl">Game URL:</label>
                        <input type="url" id="gameUrl" name="gameUrl" placeholder="https://cool-game-example.io" />
                        <div id="gameUrlPreview" class="url-preview">
                            <iframe src="about:blank" title="Game URL Preview" sandbox="allow-scripts"></iframe> <!-- Added sandbox for basic security -->
                            <span>Preview (May be blocked by game site)</span>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label for="iconUrl">Icon URL (Optional):</label>
                        <input type="url" id="iconUrl" name="iconUrl" placeholder="https://example.com/icon.png" />
                         <div id="iconUrlPreview" class="url-preview">
                             <img src="" alt="Icon Preview">
                             <span>Icon Preview</span>
                         </div>
                    </div>
                </div>
                <!-- End Game Request Fields -->

                <div style="margin-bottom: 20px;">
                    <label for="supportMessage" id="detailsLabel">Details:</label>
                    <textarea id="supportMessage" name="message" rows="4" required
                              placeholder="Please describe the issue or suggestion."></textarea>
                </div>

                <button type="submit" id="submitSupportButton" class="settings-button">Submit</button>
                <div id="supportMessageStatus" style="margin-top: 15px; text-align: center; color: var(--highlight-yellow); font-size: 0.85rem;"></div>
            </form>
        </div>
    </div>

    <!-- Edit Game Modal (Hidden by default) -->
    <div id="editGameOverlay" class="settings-overlay"></div>
    <div id="editGameModal" class="settings-popup"> <!-- Uses settings-popup for base style -->
        <div class="settings-header">
            <h2 id="editGameTitle" class="settings-title">Edit Game</h2>
            <button id="closeEditGameModal" class="header-button" title="Close">&times;</button>
        </div>
        <div class="settings-content">
            <form id="editGameForm">
                <input type="hidden" id="editGameId" name="gameId"> <!-- Store ID (index) of game being edited -->

                <div style="margin-bottom: 15px;">
                    <label for="editTitle">Title:</label>
                    <input type="text" id="editTitle" name="title" required>
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editCreator">Creator:</label>
                    <input type="text" id="editCreator" name="creator">
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editUrl">Game URL:</label>
                    <input type="url" id="editUrl" name="url" required>
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editIconUrl">Icon URL:</label>
                    <input type="url" id="editIconUrl" name="iconUrl">
                    <div id="editIconPreview" class="url-preview" style="max-width: 80px; min-height: 60px; margin-top: 5px;">
                         <img src="" alt="Icon Preview" style="max-width: 64px; max-height: 64px;">
                         <span>Icon Preview</span>
                    </div>
                </div>
                 <div style="margin-bottom: 15px;">
                     <label>Categories:</label>
                     <div id="editCategoriesContainer" class="edit-categories">
                         <!-- Checkboxes will be populated by JS -->
                         <p style="color: var(--description-color);">Loading categories...</p>
                     </div>
                 </div>
                 <div style="margin-bottom: 20px;">
                     <label>Player Count:</label>
                     <div id="editPlayerOptions" class="edit-player-options">
                         <label><input type="radio" name="players" value="1"> 1 Player</label>
                         <label><input type="radio" name="players" value="2"> 2 Players</label>
                         <label><input type="radio" name="players" value="Multi"> Multiplayer</label>
                     </div>
                 </div>

            </form>
        </div>
        <div class="settings-actions">
            <button type="button" id="cancelEditGame" class="settings-button" style="background-color: var(--button-bg); color: var(--secondary-blue);">Cancel</button>
            <button type="button" id="saveGameChanges" class="settings-button">Save Changes</button>
        </div>
    </div>
    <!-- ============================ -->


    <!-- Transition Overlay -->
    <div id="transitionOverlay" class="transition-overlay"></div>

    <!-- Particles.js Library -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

    <!-- Your Main Site Script -->
    <script>
        // --- Global Variables ---
        let googleUser = null; // To store user profile info
        const ADMIN_EMAIL = "lincolnharrison8pc@gmail.com"; // The specific admin email

        // --- Google Sign-In Handlers (GLOBAL SCOPE) ---
        function handleCredentialResponse(response) {
          console.log("Encoded JWT ID token: " + response.credential);
          try {
            const base64Url = response.credential.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            googleUser = JSON.parse(jsonPayload);
            console.log("Decoded User:", googleUser);
            updateSignInUI(true); // CALL the global function
          } catch (e) {
            console.error("Error decoding JWT:", e);
            updateSignInUI(false); // CALL the global function
          }
        }

        function handleSignOut(event) {
            console.log("Signing out...");
            googleUser = null;
            google.accounts.id.disableAutoSelect();
            updateSignInUI(false); // CALL the global function
            const adminSection = document.getElementById('admin-section');
            if (adminSection?.classList.contains('active')) {
                 console.log("Admin signed out, UI updated.");
                 // Use globally defined showView
                 showView('home-content');
            }
        }

        // --- UI Update Function (GLOBAL SCOPE) ---
        function updateSignInUI(isSignedIn) {
            const buttonDiv = document.getElementById('buttonDiv');
            const userInfoDiv = document.getElementById('userInfo');
            const userNameSpan = document.getElementById('userName');
            const userPictureImg = document.getElementById('userPicture');
            const signOutButton = document.getElementById('signOutButton');
            const adminButton = document.getElementById('adminButton');

            if (!buttonDiv || !userInfoDiv || !userNameSpan || !userPictureImg || !signOutButton || !adminButton) {
                 console.warn("updateSignInUI called before all UI elements were ready.");
                 if (document.readyState !== 'complete') {
                    document.addEventListener('DOMContentLoaded', () => updateSignInUI(isSignedIn), { once: true });
                 }
                 return;
            }

            if (isSignedIn && googleUser) {
                buttonDiv.style.display = 'none';
                userInfoDiv.style.display = 'flex';
                userNameSpan.textContent = googleUser.given_name || googleUser.name || 'User';
                userPictureImg.src = googleUser.picture || '';
                userPictureImg.alt = userNameSpan.textContent;
                signOutButton.onclick = handleSignOut;

                if (googleUser.email === ADMIN_EMAIL) {
                    console.log("Admin user detected.");
                    adminButton.style.display = 'inline-block';
                } else {
                    console.log("Regular user detected.");
                    adminButton.style.display = 'none';
                }
            } else {
                buttonDiv.style.display = 'block';
                userInfoDiv.style.display = 'none';
                userNameSpan.textContent = '';
                userPictureImg.src = '';
                adminButton.style.display = 'none';
            }
        }

        // --- View Switching Function (GLOBAL SCOPE) ---
        function showView(viewId) {
            const viewToShow = document.getElementById(viewId);
            if (!viewToShow) { console.error(`showView Error: Element '${viewId}' not found!`); return; }
             console.log(`--> Activating view: ${viewId}`);
             // Query sections here as they might not be available when this is first defined
             document.querySelectorAll('.view-section').forEach(section => section.classList.remove('active'));
             requestAnimationFrame(() => { viewToShow.classList.add('active'); viewToShow.scrollTop = 0; });
        }

        // --- Debounce Helper Function (GLOBAL SCOPE) ---
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };


        // --- Google Library Initialization (GLOBAL SCOPE) ---
        window.onload = function () {
          google.accounts.id.initialize({
            client_id: "881545540885-84jq8c5ha2ij9j15ikl7vb551rd22h1f.apps.googleusercontent.com", // YOUR CLIENT ID
            callback: handleCredentialResponse
          });
          google.accounts.id.renderButton(
            document.getElementById("buttonDiv"),
            { theme: "outline", size: "medium", type: "standard" }
          );
          updateSignInUI(!!googleUser); // Initial check
          // google.accounts.id.prompt();
        };


        // --- Main Script Logic (Runs AFTER DOM is loaded) ---
        document.addEventListener('DOMContentLoaded', () => {

            console.log("--- DOMContentLoaded: Initializing Script ---");

            // --- Element References ---
            const homeButton = document.getElementById('homeButton');
            const launchButton = document.getElementById('launchButton');
            const homeContent = document.getElementById('home-content');
            const gameSection = document.getElementById('game-section');
            const gamePlayerSection = document.getElementById('game-player-section');
            const helpSection = document.getElementById('help-section');
            const suggestionsButton = document.getElementById('suggestionsButton');
            const suggestionsSection = document.getElementById('suggestions-section');
            const adminButton = document.getElementById('adminButton');
            const adminSection = document.getElementById('admin-section');
            const categoryFiltersContainer = document.querySelector('.category-filters');
            const sortDropdown = document.getElementById('sortOptions');
            const gameIconsContainer = document.getElementById('icon_image');
            const fullscreenButton = document.getElementById('fullscreenButton');
            const backButton = document.getElementById('backButton');
            const viewSections = document.querySelectorAll('.view-section');
            const transitionOverlay = document.getElementById('transitionOverlay');
            const noGamesMessageElement = document.getElementById('noGamesMessage');
            // Settings Popup
            const settingsButton = document.getElementById('settingsButton');
            const settingsOverlay = document.getElementById('settingsOverlay');
            const settingsPopup = document.getElementById('settingsPopup');
            const closeSettingsButton = document.getElementById('closeSettingsButton');
            const tabCloakOptionsContainer = document.getElementById('tabCloakOptions');
            const applyCloakButton = document.getElementById('applyCloakButton');
            const resetCloakButton = document.getElementById('resetCloakButton');
            const originalTitleElement = document.getElementById('originalTitle');
            const originalFaviconElement = document.getElementById('originalFavicon');
            // Help Section & Support Form Popup
            const helpButton = document.getElementById('helpButton');
            const requestGameBtn = document.getElementById('requestGameBtn');
            const reportIssueBtn = document.getElementById('reportIssueBtn');
            const supportFormOverlay = document.getElementById('supportFormOverlay');
            const supportFormPopup = document.getElementById('supportFormPopup');
            const closeSupportFormBtn = document.getElementById('closeSupportFormBtn');
            const supportForm = document.getElementById('supportForm');
            const supportFormTitle = document.getElementById('supportFormTitle');
            const supportType = document.getElementById('supportType');
            const supportTopic = document.getElementById('supportTopic');
            const supportMessage = document.getElementById('supportMessage');
            const submitSupportButton = document.getElementById('submitSupportButton');
            const supportMessageStatus = document.getElementById('supportMessageStatus');
            const gameRequestFields = document.getElementById('gameRequestFields');
            const topicLabel = document.getElementById('topicLabel');
            const detailsLabel = document.getElementById('detailsLabel');
            const gameUrlInput = document.getElementById('gameUrl');
            const iconUrlInput = document.getElementById('iconUrl');
            const gameUrlPreview = document.getElementById('gameUrlPreview').querySelector('iframe');
            const iconUrlPreview = document.getElementById('iconUrlPreview').querySelector('img');
             // Finder elements
            const playerCountStep = document.getElementById('player-count-step');
            const categorySelectStep = document.getElementById('category-select-step');
            const resultsStep = document.getElementById('results-step');
            const finderCategoriesContainer = document.querySelector('.finder-categories');
            const playerCountOptionsContainer = document.querySelector('.player-count-options');
            const finderResultsContainer = document.getElementById('finder-results-container');
            const finderNoResults = document.getElementById('finderNoResults');
            const restartFinderBtn = document.getElementById('restartFinderBtn');
            // Admin Elements
            const testAllGamesBtn = document.getElementById('testAllGamesBtn');
            const gameTestResultsDiv = document.getElementById('gameTestResults');
            // Search Input
            const searchInput = document.getElementById('searchInput');
             // Admin Dashboard Elements
            const adminDashboard = document.getElementById('admin-dashboard');
            const statTotalGames = document.getElementById('stat-total-games');
            const statTotalCategories = document.getElementById('stat-total-categories');
            const statGamesWithErrors = document.getElementById('stat-games-with-errors');
            const statTotalSubmissions = document.getElementById('stat-total-submissions');
            const categoryChartCanvas = document.getElementById('categoryChartCanvas');
             // Admin Game Manager Elements
            const gameManagerTableBody = document.getElementById('game-manager-table-body');
            const gameManagerStatus = document.getElementById('game-manager-status');
            const editGameOverlay = document.getElementById('editGameOverlay');
            const editGameModal = document.getElementById('editGameModal');
            const closeEditGameModal = document.getElementById('closeEditGameModal');
            const editGameForm = document.getElementById('editGameForm');
            const editGameIdInput = document.getElementById('editGameId');
            const editTitleInput = document.getElementById('editTitle');
            const editCreatorInput = document.getElementById('editCreator');
            const editUrlInput = document.getElementById('editUrl');
            const editIconUrlInput = document.getElementById('editIconUrl');
            const editIconPreviewContainer = document.getElementById('editIconPreview');
            const editCategoriesContainer = document.getElementById('editCategoriesContainer');
            const editPlayerOptionsContainer = document.getElementById('editPlayerOptions');
            const cancelEditGameBtn = document.getElementById('cancelEditGame');
            const saveGameChangesBtn = document.getElementById('saveGameChanges');


             // --- Game Data Storage ---
             let adminGamesData = []; // Holds parsed game data for admin panel
             let availableCategories = []; // Holds all unique categories found

             // --- Finder State Variables ---
             let selectedPlayerCount = null;
             let selectedFinderCategory = null;

             // --- Chart Instance Variable ---
             let categoryChartInstance = null; // To hold the chart object


            // --- Verify Crucial Elements (Add new manager/modal elements) ---
             if (!homeButton || !launchButton || !gameIconsContainer || !gamePlayerSection || !helpSection || !suggestionsSection || !adminSection || !fullscreenButton || !backButton || !transitionOverlay || !homeContent || !gameSection || !sortDropdown || !categoryFiltersContainer || !settingsButton || !helpButton || !suggestionsButton || !adminButton || !settingsOverlay || !settingsPopup || !closeSettingsButton || !tabCloakOptionsContainer || !applyCloakButton || !resetCloakButton || !originalTitleElement || !originalFaviconElement || !requestGameBtn || !reportIssueBtn || !supportFormOverlay || !supportFormPopup || !closeSupportFormBtn || !supportForm || !supportFormTitle || !supportType || !supportTopic || !supportMessage || !submitSupportButton || !supportMessageStatus || !gameRequestFields || !topicLabel || !detailsLabel || !gameUrlInput || !iconUrlInput || !gameUrlPreview || !iconUrlPreview || !playerCountStep || !categorySelectStep || !resultsStep || !finderCategoriesContainer || !playerCountOptionsContainer || !finderResultsContainer || !finderNoResults || !restartFinderBtn || !testAllGamesBtn || !gameTestResultsDiv || !searchInput || !adminDashboard || !statTotalGames || !statTotalCategories || !statGamesWithErrors || !statTotalSubmissions || !categoryChartCanvas || !gameManagerTableBody || !gameManagerStatus || !editGameOverlay || !editGameModal || !closeEditGameModal || !editGameForm || !editGameIdInput || !editTitleInput || !editCreatorInput || !editUrlInput || !editIconUrlInput || !editIconPreviewContainer || !editCategoriesContainer || !editPlayerOptionsContainer || !cancelEditGameBtn || !saveGameChangesBtn) {
                 console.error("CRITICAL STARTUP ERROR: Cannot find essential page structure elements (including dashboard/manager/modal). Verify IDs in HTML.");
                 alert("Critical page element missing. Site may not function correctly. Check console (F12).");
                 return;
             }
            console.log("Static element references verified.");

            // --- Initialize Particles.js ---
            if (document.getElementById('particles-js-container')) {
                console.log("Initializing Particles.js");
                particlesJS('particles-js-container', {
                    "particles": { "number": { "value": 80, "density": { "enable": true, "value_area": 800 } }, "color": { "value": "#ffffff" }, /* MODIFIED: White particles */ "shape": { "type": "circle", "stroke": { "width": 0, "color": "#000000" }, "polygon": { "nb_sides": 5 } }, "opacity": { "value": 0.5, "random": false, "anim": { "enable": false, "speed": 1, "opacity_min": 0.1, "sync": false } }, "size": { "value": 1.5, "random": true, "anim": { "enable": false, "speed": 40, "size_min": 0.1, "sync": false } }, "line_linked": { "enable": true, "distance": 150, "color": "#dddddd", /* MODIFIED: Light gray lines */ "opacity": 0.3, "width": 1 }, "move": { "enable": true, "speed": 2, "direction": "none", "random": false, "straight": false, "out_mode": "out", "bounce": false, "attract": { "enable": false, "rotateX": 600, "rotateY": 1200 } } }, "interactivity": { "detect_on": "canvas", "events": { "onhover": { "enable": true, "mode": "repulse" }, "onclick": { "enable": true, "mode": "push" }, "resize": true }, "modes": { "grab": { "distance": 140, "line_linked": { "opacity": 1 } }, "bubble": { "distance": 400, "size": 40, "duration": 2, "opacity": 8, "speed": 3 }, "repulse": { "distance": 100, "duration": 0.4 }, "push": { "particles_nb": 4 }, "remove": { "particles_nb": 2 } } }, "retina_detect": true
                });
            } else {
                console.warn("Particles.js container not found.");
            }

            const rootStyles = getComputedStyle(document.documentElement);
            const overlayFadeSpeedMs = parseFloat(rootStyles.getPropertyValue('--overlay-fade-speed').replace('s', '')) * 1000;
            const animationSpeedMs = parseFloat(rootStyles.getPropertyValue('--animation-speed').replace('s', '')) * 1000;
            const popupFadeSpeedMs = parseFloat(rootStyles.getPropertyValue('--popup-fade-speed').replace('s','')) * 1000;

            const ORIGINAL_TITLE = originalTitleElement.textContent;
            const ORIGINAL_FAVICON_HREF = originalFaviconElement.href;

            const cloakPresets = [
                { id: 'cloak-default', title: ORIGINAL_TITLE, favicon: ORIGINAL_FAVICON_HREF, name: 'Default (The Unblocked Zone)' },
                { id: 'cloak-classroom', title: 'Classes', favicon: 'https://ssl.gstatic.com/classroom/favicon.ico', name: 'Google Classroom' },
                { id: 'cloak-drive', title: 'My Drive - Google Drive', favicon: 'https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png', name: 'Google Drive' },
                { id: 'cloak-google', title: 'Google', favicon: 'https://google.com/favicon.ico', name: 'Google Search' },
                { id: 'cloak-canvas', title: 'Dashboard', favicon: 'https://instructure-uploads.s3.amazonaws.com/account_74060000000000001/attachments/4546/canvas_android_square.png', name: 'Canvas Dashboard' },
                { id: 'cloak-wikipedia', title: 'Wikipedia', favicon: 'https://en.wikipedia.org/static/favicon/wikipedia.ico', name: 'Wikipedia' }
            ];

            // --- Helper Functions (Defined within DOMContentLoaded) ---

            // showView is now global

            function getGameTitle(linkElement) { const caption = linkElement?.querySelector('figcaption'); const img = linkElement?.querySelector('img'); return caption?.textContent.trim() || img?.alt.trim() || ''; }
            function populateCloakOptions() {
                 tabCloakOptionsContainer.innerHTML = '';
                 const currentTitle = document.title;
                 const currentFavicon = document.querySelector("link[rel*='icon']")?.href || '';
                 cloakPresets.forEach(preset => {
                    const isChecked = (preset.title === currentTitle && preset.favicon === currentFavicon);
                    const optionDiv = document.createElement('div'); optionDiv.className = 'tab-cloak-option';
                    const radioInput = document.createElement('input'); radioInput.type = 'radio'; radioInput.id = preset.id; radioInput.name = 'tab-cloak'; radioInput.value = preset.id; radioInput.checked = isChecked; radioInput.dataset.title = preset.title; radioInput.dataset.favicon = preset.favicon;
                    const label = document.createElement('label'); label.htmlFor = preset.id;
                    const img = document.createElement('img'); img.src = preset.favicon; img.alt = ''; img.onerror = () => { img.style.display = 'none'; }; label.appendChild(img);
                    label.appendChild(document.createTextNode(` ${preset.name}`));
                    optionDiv.appendChild(radioInput); optionDiv.appendChild(label);
                    optionDiv.addEventListener('click', () => { if (!radioInput.checked) radioInput.checked = true; });
                    tabCloakOptionsContainer.appendChild(optionDiv);
                 });
                 if (!cloakPresets.some(p => p.title === currentTitle && p.favicon === currentFavicon)) {
                     const defaultRadio = tabCloakOptionsContainer.querySelector('#cloak-default');
                     if (defaultRadio) defaultRadio.checked = true;
                 }
             }
             function setTabCloak(title, faviconUrl) {
                 console.log(`Applying cloak: Title="${title}", Favicon="${faviconUrl}"`);
                 document.title = title;
                 let faviconLink = document.querySelector("link[rel*='icon']");
                 if (!faviconLink) { faviconLink = document.createElement('link'); faviconLink.rel = 'icon'; document.head.appendChild(faviconLink); console.log("Created new favicon link element."); }
                 faviconLink.href = faviconUrl;
                 localStorage.setItem('tabCloakTitle', title);
                 localStorage.setItem('tabCloakFavicon', faviconUrl);
            }
            function resetTabCloak() {
                 console.log("Resetting cloak to default.");
                 setTabCloak(ORIGINAL_TITLE, ORIGINAL_FAVICON_HREF);
                 localStorage.setItem('tabCloakTitle', ORIGINAL_TITLE);
                 localStorage.setItem('tabCloakFavicon', ORIGINAL_FAVICON_HREF);
                 const radios = tabCloakOptionsContainer.querySelectorAll('input[type="radio"]');
                 radios.forEach(radio => radio.checked = false);
                 const defaultRadio = tabCloakOptionsContainer.querySelector('#cloak-default');
                 if (defaultRadio) defaultRadio.checked = true;
            }
             function openSettingsPopup() { console.log("Opening settings popup."); populateCloakOptions(); settingsOverlay.classList.add('visible'); settingsPopup.classList.add('visible'); }
             function closeSettingsPopup() { console.log("Closing settings popup."); settingsOverlay.classList.remove('visible'); settingsPopup.classList.remove('visible'); }
            function openSupportFormPopup(type) {
                console.log(`Opening support form for: ${type}`);
                supportForm.reset(); // Clear previous input
                supportMessageStatus.textContent = ''; // Clear status
                gameUrlPreview.src = 'about:blank'; // Clear previews
                iconUrlPreview.src = '';
                supportType.value = type; // Set the hidden input value

                if (type === 'Game Request') {
                    supportFormTitle.textContent = 'Request a Game';
                    topicLabel.textContent = 'Game Name:'; // Change label
                    detailsLabel.textContent = 'Reason for Request / Other Details:'; // Change label
                    supportTopic.placeholder = 'Enter the name of the game';
                    supportMessage.placeholder = 'Why do you want this game? Any additional info?';
                    gameUrlInput.required = true; // Make Game URL required
                    iconUrlInput.required = false; // Icon URL is optional
                    gameRequestFields.style.display = 'block'; // Show game fields
                } else { // For 'Issue Report' or other types
                    supportFormTitle.textContent = 'Report an Issue';
                    topicLabel.textContent = 'Topic / Game Name:'; // Reset label
                    detailsLabel.textContent = 'Details:'; // Reset label
                    supportTopic.placeholder = 'e.g., Issue with Slope Game or Suggestion';
                    supportMessage.placeholder = 'Please describe the issue or suggestion.';
                    gameUrlInput.required = false; // Not required for issues
                    gameRequestFields.style.display = 'none'; // Hide game fields
                }

                supportFormOverlay.classList.add('visible');
                supportFormPopup.classList.add('visible');
                supportTopic.focus(); // Focus the first input field
            }
            function closeSupportFormPopup() {
                 console.log("Closing support form popup.");
                 supportFormOverlay.classList.remove('visible');
                 supportFormPopup.classList.remove('visible');
            }
            function sortGames() {
                if (!sortDropdown || !gameIconsContainer) return;
                const sortValue = sortDropdown.value; console.log(`    Sorting by: ${sortValue}`);
                const visibleLinks = Array.from(gameIconsContainer.querySelectorAll('.game-link')).filter(link => window.getComputedStyle(link).display !== 'none');
                if (sortValue !== 'default') {
                    visibleLinks.sort((a, b) => { const titleA = getGameTitle(a).toLowerCase(); const titleB = getGameTitle(b).toLowerCase(); if (sortValue === 'az') return titleA.localeCompare(titleB); if (sortValue === 'za') return titleB.localeCompare(titleA); return 0; });
                    visibleLinks.forEach(link => gameIconsContainer.appendChild(link)); console.log(`    Sorted and re-appended ${visibleLinks.length} items by ${sortValue}`);
                }
             }
             function filterGames(filter) {
                console.log(`--- filterGames called with filter: ${filter} ---`);
                if (!gameIconsContainer) { console.error("Filter Error: Cannot find #icon_image"); return; }

                // Clear search input when category changes
                if (searchInput) {
                    searchInput.value = '';
                }

                const gameLinks = gameIconsContainer.querySelectorAll('.game-link'); let visibleCount = 0;
                gameLinks.forEach(link => { const shouldShow = (filter === 'All' || link.classList.contains(filter)); link.style.display = shouldShow ? 'block' : 'none'; if (shouldShow) visibleCount++; });

                // Update no games message based ONLY on category first
                if (noGamesMessageElement) {
                     noGamesMessageElement.style.display = (visibleCount === 0 && filter !== 'All') ? 'block' : 'none';
                     if(visibleCount === 0 && filter !== 'All') noGamesMessageElement.textContent = `No games found in "${filter}".`;
                     else if (visibleCount > 0) noGamesMessageElement.style.display = 'none'; // Hide if category has games
                 }

                sortGames(); // Apply sort order
                console.log(`--- filterGames finished for filter: ${filter}, visible: ${visibleCount} ---`);
            }
            function populateFinderCategories() {
                if (!categoryFiltersContainer || !finderCategoriesContainer) return;
                const originalButtons = categoryFiltersContainer.querySelectorAll('.category-button:not([data-filter="All"])');
                 finderCategoriesContainer.innerHTML = ''; // Clear previous if any
                 const anyButton = document.createElement('button');
                 anyButton.className = 'category-button active-category'; // Default active
                 anyButton.dataset.filter = 'Any';
                 anyButton.textContent = 'Any Category';
                 finderCategoriesContainer.appendChild(anyButton);

                originalButtons.forEach(btn => {
                    const clone = btn.cloneNode(true);
                    clone.classList.remove('active-category');
                    finderCategoriesContainer.appendChild(clone);
                });
                 console.log(`Copied ${originalButtons.length} categories to finder.`);
             }
             populateFinderCategories(); // Call it once during initialization
             function showFinderStep(stepId) {
                document.querySelectorAll('.finder-step').forEach(step => {
                    step.classList.remove('active-step');
                });
                const stepToShow = document.getElementById(stepId);
                if (stepToShow) {
                    stepToShow.classList.add('active-step');
                    if (suggestionsSection) suggestionsSection.scrollTop = 0; // Scroll suggestions view
                } else {
                     console.error("Finder step not found:", stepId);
                }
             }
             function filterGamesForFinder() {
                 console.log(`Filtering for: Players=${selectedPlayerCount}, Category=${selectedFinderCategory}`);
                 const allGames = Array.from(gameIconsContainer.querySelectorAll('a.game-link'));
                 let filteredGames = allGames;

                // 1. Filter by Player Count
                 if (selectedPlayerCount) { // No "Any" button for players
                     filteredGames = filteredGames.filter(gameLink => {
                         const players = gameLink.dataset.players || '1'; // Default to 1 if missing

                        if (selectedPlayerCount === '1') {
                             return players === '1';
                        } else if (selectedPlayerCount === '2') {
                             return players === '2' || players === 'Multi'; // Show 2 and Multi
                         } else if (selectedPlayerCount === '3+') { // Handles 3 and 3+ from buttons
                            return players === 'Multi'; // Only show games marked as Multi
                         }
                         return false; // Should not happen if buttons are clicked
                    });
                 }
                 console.log(` After player filter (${selectedPlayerCount}): ${filteredGames.length} games`);

                 // 2. Filter by Category
                 if (selectedFinderCategory && selectedFinderCategory !== 'Any') {
                     filteredGames = filteredGames.filter(gameLink => gameLink.classList.contains(selectedFinderCategory));
                 }
                 console.log(` After category filter (${selectedFinderCategory}): ${filteredGames.length} games`);

                 return filteredGames;
             }
             function displayFinderResults(games) {
                finderResultsContainer.innerHTML = ''; // Clear previous results
                finderNoResults.style.display = 'none';

                if (!games || games.length === 0) {
                    finderNoResults.style.display = 'block';
                     console.log("No matching games found.");
                    return;
                }

                console.log(`Displaying ${games.length} results.`);
                games.forEach(gameLink => {
                     const gameUrl = gameLink.dataset.gameUrl;
                     const gameTitle = getGameTitle(gameLink);
                     const gameCreator = gameLink.dataset.gameCreator || 'Unknown';
                     const iconSrc = gameLink.querySelector('img')?.src || '';
                      const categories = Array.from(gameLink.classList).filter(c =>
                          !['game-link', 'New'].includes(c) && // Exclude base/temp classes
                          !c.startsWith('data-') &&             // Exclude data attributes
                          !/^\d+$/.test(c) &&                  // Exclude simple numbers (like player counts if used as class)
                          c !== 'Multi' &&                      // Exclude specific player keywords
                          c !== '1' && c !== '2'                // Exclude player numbers if used as classes
                      );

                    const resultDiv = document.createElement('div');
                    resultDiv.className = 'finder-result-item';

                    const img = document.createElement('img');
                     img.src = iconSrc;
                     img.alt = gameTitle;
                     img.loading = 'lazy';
                     img.onerror = () => { img.style.display = 'none'; }; // Hide if icon fails

                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'finder-result-info';

                    const titleH4 = document.createElement('h4');
                     titleH4.className = 'finder-result-title';
                     titleH4.textContent = gameTitle;

                    const creatorSmall = document.createElement('small');
                     creatorSmall.className = 'finder-result-creator';
                     creatorSmall.textContent = `by ${gameCreator}`;

                     // Create Category Tags
                     const categoriesDiv = document.createElement('div');
                     categoriesDiv.className = 'finder-result-categories';
                     categories.forEach(cat => {
                          if (cat) { // Ensure category is not empty string
                             const catSpan = document.createElement('span');
                             catSpan.textContent = cat;
                             categoriesDiv.appendChild(catSpan);
                         }
                     });

                    const playBtn = document.createElement('button');
                     playBtn.className = 'finder-result-play-btn';
                     playBtn.textContent = 'Play';
                     playBtn.dataset.gameUrl = gameUrl;
                     playBtn.dataset.gameTitle = gameTitle;
                     playBtn.dataset.gameCreator = gameCreator;

                     infoDiv.appendChild(titleH4);
                     infoDiv.appendChild(creatorSmall);
                     infoDiv.appendChild(categoriesDiv); // Add categories div

                     resultDiv.appendChild(img);
                     resultDiv.appendChild(infoDiv);
                     resultDiv.appendChild(playBtn);

                     finderResultsContainer.appendChild(resultDiv);
                 });
            }
            function runFinder() {
                 const filteredGames = filterGamesForFinder();
                 displayFinderResults(filteredGames);
                 showFinderStep('results-step');
             }
            // --- Search Filtering Function ---
            const debouncedSearch = debounce((term) => {
                 filterGamesBySearch(term);
             }, 250); // 250ms delay

            function filterGamesBySearch(searchTerm) {
                const searchTermLower = searchTerm.toLowerCase().trim();
                const gameLinks = gameIconsContainer.querySelectorAll('.game-link');
                let visibleCount = 0;

                gameLinks.forEach(link => {
                    const title = getGameTitle(link).toLowerCase();
                    const creator = (link.dataset.gameCreator || '').toLowerCase();
                    const isMatch = title.includes(searchTermLower) || creator.includes(searchTermLower);
                    const currentCategoryFilter = categoryFiltersContainer?.querySelector('.active-category')?.dataset.filter || 'All';
                    const isInCurrentCategory = (currentCategoryFilter === 'All' || link.classList.contains(currentCategoryFilter));
                    const shouldShow = isMatch && isInCurrentCategory;

                    link.style.display = shouldShow ? 'block' : 'none';
                    if (shouldShow) visibleCount++;
                });

                if (noGamesMessageElement) {
                     const currentCategoryFilter = categoryFiltersContainer?.querySelector('.active-category')?.dataset.filter || 'All';
                     const categoryText = currentCategoryFilter === 'All' ? '' : ` in "${currentCategoryFilter}"`;
                     noGamesMessageElement.style.display = (visibleCount === 0) ? 'block' : 'none';
                     if (visibleCount === 0) {
                        noGamesMessageElement.textContent = `No games found matching "${searchTerm}"${categoryText}.`;
                     }
                 }
                 sortGames(); // Re-apply sort after filtering
                 console.log(`Search for "${searchTerm}" finished, visible: ${visibleCount}`);
            }

            // ===== Update Admin Dashboard Function =====
            function updateAdminDashboard() {
                if (!adminSection.classList.contains('active')) return; // Only update if visible
                console.log("Updating Admin Dashboard...");

                // --- Calculate Stats ---
                const totalGames = adminGamesData.length; // Use parsed data length
                // Recalculate total categories based on availableCategories array
                // Ensure availableCategories is populated if not already
                if(availableCategories.length === 0 && adminGamesData.length > 0) {
                     availableCategories = [...new Set(adminGamesData.flatMap(game => game.categories.filter(cat => cat)))].sort();
                }
                const totalCategoriesCount = availableCategories.length;

                // Games with Errors (Check if results are visible and contain errors)
                let gamesWithErrors = '--';
                 if (gameTestResultsDiv.style.display === 'block' && gameTestResultsDiv.innerHTML.includes('status-error')) {
                     gamesWithErrors = gameTestResultsDiv.querySelectorAll('.status-error').length;
                 } else if (gameTestResultsDiv.style.display === 'block') {
                    gamesWithErrors = 0; // Test ran, no errors found
                 }

                // --- Fetch Total Submissions Count ---
                const SCRIPT_COUNT_URL = 'https://script.google.com/macros/s/AKfycbz-oAR3GGVgCkzbpe5rLXq_U4c_eVx2n5W1Ih-lN0fF5fwE11fubZ3R2OGgBcVvQeR7vw/exec'; // <<< YOUR URL INSERTED HERE
                let submissionStatValue = statTotalSubmissions.textContent; // Keep current value unless fetch changes it
                if (submissionStatValue === '--' || submissionStatValue === 'N/A' || submissionStatValue === 'Error') { // Only show loading if not already loaded/error
                     submissionStatValue = 'Loading...';
                     statTotalSubmissions.textContent = submissionStatValue;
                     // Reset small text visibility
                     const submissionsSmallText = statTotalSubmissions.closest('.stat-item')?.querySelector('small');
                     if(submissionsSmallText) submissionsSmallText.style.display = 'inline';

                    if (SCRIPT_COUNT_URL && !SCRIPT_COUNT_URL.includes('PASTE_YOUR')) {
                        fetch(SCRIPT_COUNT_URL + '?action=count') // Append a query param to ensure GET
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                console.log("Submission count data:", data);
                                if (data.result === 'success' && typeof data.count !== 'undefined') {
                                    submissionStatValue = data.count; // Update the variable
                                } else {
                                    console.error("Error getting submission count:", data.message || 'Invalid response format');
                                    submissionStatValue = 'Error';
                                }
                                // Update DOM *after* fetch completes
                                statTotalSubmissions.textContent = submissionStatValue;
                                // If you have a 'small' tag associated, you might want to hide/remove it on success
                                const submissionsSmallText = statTotalSubmissions.closest('.stat-item')?.querySelector('small');
                                if (submissionsSmallText && submissionStatValue !== 'Error' && submissionStatValue !== 'Loading...') {
                                    submissionsSmallText.style.display = 'none'; // Hide the "(Requires Backend)" text
                                }

                            })
                            .catch(error => {
                                console.error('Error fetching submission count:', error);
                                submissionStatValue = 'Error';
                                // Update DOM *after* fetch error
                                statTotalSubmissions.textContent = submissionStatValue;
                            });
                    } else {
                        console.warn("Submission Count URL is not configured.");
                        submissionStatValue = 'N/A'; // Keep as N/A if URL not set
                        statTotalSubmissions.textContent = submissionStatValue; // Update DOM immediately if URL is missing
                        const submissionsSmallText = statTotalSubmissions.closest('.stat-item')?.querySelector('small');
                        if (submissionsSmallText) submissionsSmallText.style.display = 'inline'; // Ensure small text shows if URL missing
                    }
                } // End if needs loading
                // -------------------------------------

                // --- Update Stat Display (for stats NOT fetched async) ---
                statTotalGames.textContent = totalGames;
                statTotalCategories.textContent = totalCategoriesCount;
                statGamesWithErrors.textContent = gamesWithErrors;
                // statTotalSubmissions is updated above and async inside fetch

                // --- Prepare Chart Data (using parsed adminGamesData) ---
                const categoryCounts = {};
                adminGamesData.forEach(game => {
                    game.categories.forEach(cat => {
                        if (cat) { categoryCounts[cat] = (categoryCounts[cat] || 0) + 1; }
                    });
                });

                const chartLabels = Object.keys(categoryCounts);
                const chartData = Object.values(categoryCounts);

                // Generate colors dynamically (simple example)
                const chartColors = chartLabels.map((_, index) => {
                    const hue = (index * (360 / (chartLabels.length * 1.5))) % 360; // Distribute hues
                    return `hsla(${hue}, 70%, 60%, 0.7)`; // Use HSLA for transparency
                });
                 const chartBorderColors = chartLabels.map((_, index) => {
                    const hue = (index * (360 / (chartLabels.length * 1.5))) % 360; // Distribute hues
                    return `hsl(${hue}, 70%, 50%)`; // Solid border
                });


                // --- Render Chart ---
                if (categoryChartCanvas) {
                    const ctx = categoryChartCanvas.getContext('2d');

                    // Destroy previous chart instance if it exists
                    if (categoryChartInstance) {
                        categoryChartInstance.destroy();
                        categoryChartInstance = null;
                         console.log("Previous chart instance destroyed.");
                    }

                    // Only create chart if there's data
                     if (chartLabels.length > 0) {
                         console.log(`Creating chart with ${chartLabels.length} categories.`);
                        try {
                            Chart.defaults.color = 'rgba(224, 224, 224, 0.8)'; // Set default text color for Chart.js
                            Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)'; // Default border for elements

                            categoryChartInstance = new Chart(ctx, {
                                type: 'pie', // Or 'doughnut'
                                data: {
                                    labels: chartLabels,
                                    datasets: [{
                                        label: 'Games',
                                        data: chartData,
                                        backgroundColor: chartColors,
                                        borderColor: chartBorderColors, // Use brighter borders
                                        borderWidth: 1,
                                        hoverOffset: 4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false, // Allow height limiting
                                    plugins: {
                                        legend: {
                                            position: 'top', // Or 'bottom', 'left', 'right'
                                            labels: {
                                                 boxWidth: 15,
                                                 padding: 15
                                            }
                                        },
                                        title: {
                                            display: false, // Title is already in the container H3
                                        },
                                        tooltip: {
                                            backgroundColor: 'rgba(10, 15, 26, 0.9)',
                                            titleColor: '#ffffff',
                                            bodyColor: '#e0e0e0',
                                            borderColor: 'rgba(255, 255, 255, 0.5)',
                                            borderWidth: 1
                                        }
                                    }
                                }
                            });
                        } catch(error) {
                            console.error("Error creating chart:", error);
                             ctx.clearRect(0, 0, categoryChartCanvas.width, categoryChartCanvas.height);
                             ctx.fillStyle = 'rgba(224, 224, 224, 0.5)';
                             ctx.textAlign = 'center';
                             ctx.fillText("Error rendering chart", categoryChartCanvas.width / 2, categoryChartCanvas.height / 2);
                        }
                    } else {
                         console.log("No category data to create chart.");
                         ctx.clearRect(0, 0, categoryChartCanvas.width, categoryChartCanvas.height);
                         ctx.fillStyle = 'rgba(224, 224, 224, 0.5)';
                         ctx.textAlign = 'center';
                         ctx.fillText("No category data available", categoryChartCanvas.width / 2, categoryChartCanvas.height / 2);
                    }
                } else {
                    console.error("Category chart canvas not found!");
                }
                 console.log("Admin Dashboard update complete.");
            } // ===== End updateAdminDashboard Function =====

             // --- Game Manager Functions ---
             function parseGamesFromDOM() {
                console.log("Parsing games from DOM for admin manager...");
                adminGamesData = []; // Clear existing data
                availableCategories = []; // Clear existing categories
                const gameLinks = gameIconsContainer.querySelectorAll('a.game-link');
                const uniqueCategories = new Set();

                gameLinks.forEach((link, index) => {
                    const categories = Array.from(link.classList).filter(c =>
                        !['game-link', 'New'].includes(c) && // Exclude base/temp classes
                        !c.startsWith('data-') &&             // Exclude data attributes
                        !/^\d+$/.test(c) &&                  // Exclude simple numbers
                        c !== 'Multi' &&                      // Exclude specific player keywords
                        c !== '1' && c !== '2'                // Exclude player numbers
                    );
                    categories.forEach(cat => { if(cat) uniqueCategories.add(cat) }); // Collect unique categories, ignore empty strings

                    adminGamesData.push({
                        id: index, // Use index as a temporary unique ID
                        title: getGameTitle(link),
                        creator: link.dataset.gameCreator || '',
                        url: link.dataset.gameUrl || '',
                        iconUrl: link.querySelector('img')?.src || '',
                        categories: categories.filter(cat => cat), // Filter out empty strings here too
                        players: link.dataset.players || '1' // Default to '1' if missing
                    });
                });
                availableCategories = Array.from(uniqueCategories).sort(); // Store sorted unique categories
                console.log(`Parsed ${adminGamesData.length} games. Found categories:`, availableCategories);
                return adminGamesData; // Return the parsed data
             }

             function renderAdminGameTable() {
                console.log("Rendering admin game table...");
                if (!gameManagerTableBody) return;
                gameManagerTableBody.innerHTML = ''; // Clear existing rows

                if (adminGamesData.length === 0) {
                    gameManagerTableBody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding: 20px;">No game data found or parsed.</td></tr>';
                    return;
                }

                adminGamesData.forEach(game => {
                    const row = gameManagerTableBody.insertRow();
                    row.dataset.gameId = game.id; // Store game ID on the row

                    // Icon
                    const iconCell = row.insertCell();
                    iconCell.className = 'game-icon-cell';
                    iconCell.innerHTML = `<img src="${game.iconUrl}" alt="Icon" loading="lazy" onerror="this.style.display='none'">`;

                    // Title
                    row.insertCell().textContent = game.title;

                    // Creator
                    row.insertCell().textContent = game.creator;

                    // Categories
                    const catCell = row.insertCell();
                    catCell.className = 'game-categories-cell';
                    catCell.innerHTML = game.categories.map(cat => `<span>${cat}</span>`).join('');

                    // Players
                    const playerCell = row.insertCell();
                    playerCell.className = 'game-players-cell'; // Added class
                    playerCell.textContent = game.players === 'Multi' ? 'Multi' : `${game.players}P`;


                    // URL
                    const urlCell = row.insertCell();
                    urlCell.className = 'game-url-cell';
                    urlCell.innerHTML = `<a href="${game.url}" target="_blank" title="${game.url}">${game.url}</a>`;

                    // Actions
                    const actionsCell = row.insertCell();
                    actionsCell.className = 'actions-cell';
                    actionsCell.innerHTML = `
                        <button class="edit-btn" title="Edit Game"><i class="fas fa-pencil-alt"></i></button>
                        <button class="delete-btn" title="Delete Game"><i class="fas fa-trash-alt"></i></button>
                    `;
                });
                console.log(`Rendered ${adminGamesData.length} games into admin table.`);
             }

             function openEditGameModal(gameId) {
                 const gameData = adminGamesData.find(g => g.id === parseInt(gameId));
                 if (!gameData) {
                     console.error("Game data not found for ID:", gameId);
                     alert("Error: Could not find game data to edit.");
                     return;
                 }
                 console.log("Opening edit modal for game:", gameData.title);

                 // Populate form
                 editGameIdInput.value = gameData.id;
                 editTitleInput.value = gameData.title;
                 editCreatorInput.value = gameData.creator;
                 editUrlInput.value = gameData.url;
                 editIconUrlInput.value = gameData.iconUrl;

                 // Populate categories checkboxes
                 editCategoriesContainer.innerHTML = ''; // Clear old checkboxes
                 availableCategories.forEach(cat => {
                     const isChecked = gameData.categories.includes(cat);
                     const checkboxId = `edit-cat-${cat.replace(/\s+/g, '-')}-${gameId}`; // Unique ID
                     const label = document.createElement('label');
                     label.setAttribute('for', checkboxId);
                     const checkbox = document.createElement('input');
                     checkbox.type = 'checkbox';
                     checkbox.value = cat;
                     checkbox.checked = isChecked;
                     checkbox.id = checkboxId;
                     label.appendChild(checkbox);
                     label.appendChild(document.createTextNode(` ${cat}`));
                     editCategoriesContainer.appendChild(label);
                 });

                  // Populate player count radio buttons
                  const playerRadios = editPlayerOptionsContainer.querySelectorAll('input[name="players"]');
                  playerRadios.forEach(radio => {
                      radio.checked = (radio.value === gameData.players);
                  });

                  // Show icon preview
                  const previewImg = editIconPreviewContainer.querySelector('img');
                  previewImg.src = gameData.iconUrl || ''; // Set src, will trigger onerror/onload naturally


                 // Show modal
                 editGameOverlay.classList.add('visible');
                 editGameModal.classList.add('visible');
             }

             function closeEditGameModal() {
                 editGameOverlay.classList.remove('visible');
                 editGameModal.classList.remove('visible');
                 editGameForm.reset(); // Reset form fields
                 const previewImg = editIconPreviewContainer.querySelector('img');
                 previewImg.src = ''; // Clear preview
                 editGameIdInput.value = ''; // Clear hidden ID
             }

            function saveGameEdit() {
                 const gameId = parseInt(editGameIdInput.value);
                 const gameIndex = adminGamesData.findIndex(g => g.id === gameId);

                 if (gameIndex === -1) {
                     console.error("Cannot save, game index not found for ID:", gameId);
                     alert("Error saving changes: Game not found.");
                     return;
                 }

                 // Get updated categories
                 const selectedCategories = [];
                 editCategoriesContainer.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                     selectedCategories.push(checkbox.value);
                 });

                  // Get updated player count
                  const selectedPlayerRadio = editPlayerOptionsContainer.querySelector('input[name="players"]:checked');
                  const updatedPlayers = selectedPlayerRadio ? selectedPlayerRadio.value : '1'; // Default to '1' if none selected

                 // Update the game data in the JS array
                 adminGamesData[gameIndex] = {
                     ...adminGamesData[gameIndex], // Keep existing id
                     title: editTitleInput.value.trim(),
                     creator: editCreatorInput.value.trim(),
                     url: editUrlInput.value.trim(),
                     iconUrl: editIconUrlInput.value.trim(),
                     categories: selectedCategories,
                     players: updatedPlayers
                 };

                 console.log("Updated game data (client-side):", adminGamesData[gameIndex]);
                 alert(`Game "${adminGamesData[gameIndex].title}" updated (session only).`);

                 // Re-render the table and update dashboard stats
                 renderAdminGameTable();
                 updateAdminDashboard();
                 closeEditGameModal();
                 // **Reminder:** Need to implement actual saving (to file/backend) here later.
            }

            function deleteGame(gameId) {
                 const gameIndex = adminGamesData.findIndex(g => g.id === parseInt(gameId));
                 if (gameIndex === -1) {
                     console.error("Cannot delete, game index not found for ID:", gameId);
                     alert("Error deleting game: Game not found.");
                     return;
                 }

                 const gameTitle = adminGamesData[gameIndex].title;
                 if (confirm(`Are you sure you want to delete "${gameTitle}"? This is temporary for this session.`)) {
                     adminGamesData.splice(gameIndex, 1); // Remove game from array
                     console.log(`Deleted game "${gameTitle}" (client-side)`);
                     alert(`Game "${gameTitle}" deleted (session only).`);

                     // Re-render table and update dashboard
                     renderAdminGameTable();
                     updateAdminDashboard();
                     // **Reminder:** Need to implement actual deletion (from file/backend) here later.
                 }
            }


             // --- Event Listeners ---
             if(launchButton) { launchButton.addEventListener('click', () => { const currentSuggestionsView = document.getElementById('suggestions-section'); const currentAdminView = document.getElementById('admin-section'); const currentHelpView = document.getElementById('help-section'); if (currentSuggestionsView?.classList.contains('active') || currentAdminView?.classList.contains('active') || currentHelpView?.classList.contains('active')) { /* Optional cleanup if needed */ } showView('game-section'); const allButton = categoryFiltersContainer?.querySelector('.category-button[data-filter="All"]'); if (allButton && categoryFiltersContainer) { categoryFiltersContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category')); allButton.classList.add('active-category'); } if (sortDropdown) sortDropdown.value = 'az'; filterGames('All'); }); console.log("Launch Button listener attached."); }
             if (homeButton) { homeButton.addEventListener('click', () => { console.log("Home clicked."); const frame = document.getElementById('gameFrame'); const title = document.getElementById('currentGameTitle'); const creator = document.getElementById('currentGameCreator'); const playerView = document.getElementById('game-player-section'); const currentHelpView = document.getElementById('help-section'); const currentSuggestionsView = document.getElementById('suggestions-section'); const currentAdminView = document.getElementById('admin-section'); if (playerView?.classList.contains('active') || currentHelpView?.classList.contains('active') || currentSuggestionsView?.classList.contains('active') || currentAdminView?.classList.contains('active') ) { console.log("   Cleaning player/state before going home"); try { if (frame?.contentWindow?.stop) { frame.contentWindow.stop(); } } catch (e) {} if (frame) frame.src = 'about:blank'; if (title) title.textContent = "Game Title"; if (creator) creator.textContent = "Creator"; if (document.fullscreenElement) { (document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen)?.call(document); } } if(homeContent) showView('home-content'); }); console.log("Home button listener attached."); }
            // Suggestions Button (NOW triggers the finder steps)
            if (suggestionsButton) { suggestionsButton.addEventListener('click', () => { console.log("Suggestions clicked, starting finder."); const playerView = document.getElementById('game-player-section'); const currentAdminView = document.getElementById('admin-section'); const currentHelpView = document.getElementById('help-section'); if (playerView?.classList.contains('active') || currentAdminView?.classList.contains('active') || currentHelpView?.classList.contains('active')) { const frame = document.getElementById('gameFrame'); const title = document.getElementById('currentGameTitle'); const creator = document.getElementById('currentGameCreator'); console.log("   Cleaning player/state before showing suggestions"); try { if (frame?.contentWindow?.stop) { frame.contentWindow.stop(); } } catch (e) {} if (frame) frame.src = 'about:blank'; if (title) title.textContent = "Game Title"; if (creator) creator.textContent = "Creator"; if (document.fullscreenElement) { (document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen)?.call(document); } } selectedPlayerCount = null; selectedFinderCategory = null; finderResultsContainer.innerHTML = ''; finderNoResults.style.display = 'none'; finderCategoriesContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category')); finderCategoriesContainer.querySelector('[data-filter="Any"]')?.classList.add('active-category'); showView('suggestions-section'); showFinderStep('player-count-step'); }); console.log("Suggestions button listener attached."); }
             // Help Button (Main)
             if (helpButton) { helpButton.addEventListener('click', () => { console.log("Help clicked."); const playerView = document.getElementById('game-player-section'); const currentSuggestionsView = document.getElementById('suggestions-section'); const currentAdminView = document.getElementById('admin-section'); if (playerView?.classList.contains('active') || currentSuggestionsView?.classList.contains('active') || currentAdminView?.classList.contains('active')) { const frame = document.getElementById('gameFrame'); const title = document.getElementById('currentGameTitle'); const creator = document.getElementById('currentGameCreator'); console.log("   Cleaning player/state before showing help"); try { if (frame?.contentWindow?.stop) { frame.contentWindow.stop(); } } catch (e) {} if (frame) frame.src = 'about:blank'; if (title) title.textContent = "Game Title"; if (creator) creator.textContent = "Creator"; if (document.fullscreenElement) { (document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen)?.call(document); } } if (helpSection) showView('help-section'); }); console.log("Help button listener attached."); }
             // Admin Button Listener
             if (adminButton) { adminButton.addEventListener('click', () => { if (googleUser && googleUser.email === ADMIN_EMAIL) { console.log("Admin button clicked."); const playerView = document.getElementById('game-player-section'); const currentHelpView = document.getElementById('help-section'); const currentSuggestionsView = document.getElementById('suggestions-section'); if (playerView?.classList.contains('active') || currentHelpView?.classList.contains('active') || currentSuggestionsView?.classList.contains('active')) { const frame = document.getElementById('gameFrame'); const title = document.getElementById('currentGameTitle'); const creator = document.getElementById('currentGameCreator'); console.log("   Cleaning player/state before showing admin panel"); try { if (frame?.contentWindow?.stop) { frame.contentWindow.stop(); } } catch (e) {} if (frame) frame.src = 'about:blank'; if (title) title.textContent = "Game Title"; if (creator) creator.textContent = "Creator"; if (document.fullscreenElement) { (document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen)?.call(document); } }
                 showView('admin-section');
                 parseGamesFromDOM(); // <<< Parse games when admin panel opens
                 renderAdminGameTable(); // <<< Render table
                 updateAdminDashboard(); // <<< Update dashboard stats & chart
             } else { console.warn("Non-admin tried to access admin panel via button click?"); adminButton.style.display = 'none'; } }); console.log("Admin button listener attached."); }
             // Game Section Specific Filters
             if (categoryFiltersContainer) { categoryFiltersContainer.addEventListener('click', (event) => { if (event.target.classList.contains('category-button')) { const filterValue = event.target.dataset.filter; categoryFiltersContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category')); event.target.classList.add('active-category'); filterGames(filterValue); } }); console.log("Category filter listener attached."); }
             if (sortDropdown) { sortDropdown.addEventListener('change', sortGames); console.log("Sort dropdown listener attached."); }
             if (gameIconsContainer) { gameIconsContainer.addEventListener('click', (event) => { console.log("Game icon clicked"); const gameLink = event.target.closest('a.game-link'); if (!gameLink || window.getComputedStyle(gameLink).display === 'none') return; event.preventDefault(); const gameUrl = gameLink.dataset.gameUrl; const gameTitle = getGameTitle(gameLink); const gameCreator = gameLink.dataset.gameCreator || 'Unknown'; console.log(`    Processing game: ${gameTitle}`); const titleElement = document.getElementById('currentGameTitle'); const creatorElement = document.getElementById('currentGameCreator'); const frameElement = document.getElementById('gameFrame'); const playerViewElement = document.getElementById('game-player-section'); if (gameUrl && titleElement && creatorElement && frameElement && playerViewElement) { titleElement.textContent = gameTitle; creatorElement.textContent = `by ${gameCreator}`; frameElement.src = 'about:blank'; requestAnimationFrame(() => { frameElement.src = gameUrl; }); showView(playerViewElement.id); console.log("    Game player view activated."); } else { console.error("    CLICK ERROR: Missing Player Elements!", { titleEl:!!titleElement, creatorEl:!!creatorElement, frameEl:!!frameElement, playerViewEl:!!playerViewElement }); alert("Error loading game components. Check console (F12)."); } }); console.log("Game icon listener attached."); }
             // Game Player Controls
             if (backButton) { backButton.addEventListener('click', () => { console.log("Back clicked."); const frame = document.getElementById('gameFrame'); const title = document.getElementById('currentGameTitle'); const creator = document.getElementById('currentGameCreator'); try { if (frame?.contentWindow?.stop) { frame.contentWindow.stop(); } } catch (e) {} if (frame) frame.src = 'about:blank'; if (title) title.textContent = "Game Title"; if (creator) creator.textContent = "Creator"; if(gameSection) { showView('game-section'); const currentFilter = categoryFiltersContainer?.querySelector('.active-category')?.dataset.filter || 'All'; filterGames(currentFilter); } }); console.log("Back Button listener attached."); }
             const fullscreenButtonRef = document.getElementById('fullscreenButton'); if (fullscreenButtonRef) { fullscreenButtonRef.addEventListener('click', () => { const iframe = document.getElementById('gameFrame'); const playerBox = document.querySelector('.game-player-box'); if(!iframe) { console.error("FS Error: iframe missing"); return; }; if (!document.fullscreenElement) { (iframe.requestFullscreen || iframe.webkitRequestFullscreen || iframe.msRequestFullscreen)?.call(iframe).catch(e => { console.warn(`iframe FS failed: ${e.message}, trying box`); (playerBox?.requestFullscreen || playerBox?.webkitRequestFullscreen || playerBox?.msRequestFullscreen)?.call(playerBox).catch(e2 => {console.error(`Box FS failed`,e2); alert("FS mode failed.");}); });} else { (document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen)?.call(document); } }); function handleFullscreenChange() { const isInFullscreen = !!(document.fullscreenElement || document.webkitIsFullScreen || document.msFullscreenElement); const fsBtn = document.getElementById('fullscreenButton'); if(fsBtn) { if (isInFullscreen) { fsBtn.innerHTML = '<i class="fas fa-compress"></i>'; fsBtn.title = "Exit Fullscreen"; } else { fsBtn.innerHTML = '<i class="fas fa-expand"></i>'; fsBtn.title = "Toggle Fullscreen"; } } } document.addEventListener('fullscreenchange', handleFullscreenChange); document.addEventListener('webkitfullscreenchange', handleFullscreenChange); document.addEventListener('msfullscreenchange', handleFullscreenChange); console.log("Fullscreen listeners attached."); }
             // Settings Popup Listeners
             if (settingsButton) { settingsButton.addEventListener('click', openSettingsPopup); console.log("Settings button listener attached."); }
             if (closeSettingsButton) { closeSettingsButton.addEventListener('click', closeSettingsPopup); console.log("Close Settings button listener attached."); }
             if (settingsOverlay) { settingsOverlay.addEventListener('click', closeSettingsPopup); console.log("Settings overlay listener attached."); }
             if (settingsPopup) { settingsPopup.addEventListener('click', (event) => { event.stopPropagation(); }); } // Prevent closing when clicking inside popup
             if (applyCloakButton) { applyCloakButton.addEventListener('click', () => { const selectedRadio = tabCloakOptionsContainer.querySelector('input[name="tab-cloak"]:checked'); if (selectedRadio) { const title = selectedRadio.dataset.title; const favicon = selectedRadio.dataset.favicon; setTabCloak(title, favicon); closeSettingsPopup(); } else { console.warn("Apply Cloak: No option selected."); } }); console.log("Apply Cloak button listener attached."); }
             if (resetCloakButton) { resetCloakButton.addEventListener('click', () => { resetTabCloak(); }); console.log("Reset Cloak button listener attached."); }

             // --- Attach Listeners for Help Section Buttons ---
             if (requestGameBtn) { requestGameBtn.addEventListener('click', (e) => { e.preventDefault(); openSupportFormPopup('Game Request'); }); console.log("Request Game button listener attached."); }
             if (reportIssueBtn) { reportIssueBtn.addEventListener('click', (e) => { e.preventDefault(); openSupportFormPopup('Issue Report'); }); console.log("Report Issue button listener attached."); }

             // --- Attach Listeners for Closing Support Form ---
             if (closeSupportFormBtn) { closeSupportFormBtn.addEventListener('click', closeSupportFormPopup); console.log("Close Support Form button listener attached."); }
             if (supportFormOverlay) { supportFormOverlay.addEventListener('click', closeSupportFormPopup); console.log("Support Form overlay listener attached."); }
             if (supportFormPopup) { supportFormPopup.addEventListener('click', (event) => { event.stopPropagation(); }); } // Prevent closing when clicking inside popup

            // --- URL Preview Listeners ---
            if (gameUrlInput && gameUrlPreview) {
                gameUrlInput.addEventListener('input', () => {
                    const url = gameUrlInput.value.trim();
                    if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
                        clearTimeout(gameUrlInput.previewTimeout);
                        gameUrlInput.previewTimeout = setTimeout(() => {
                             console.log("Attempting to preview game URL:", url);
                             gameUrlPreview.src = 'about:blank'; // Clear first
                             requestAnimationFrame(() => { gameUrlPreview.src = url; });
                        }, 500); // Delay in ms
                    } else {
                        clearTimeout(gameUrlInput.previewTimeout);
                        gameUrlPreview.src = 'about:blank'; // Clear preview if invalid/empty
                    }
                });
                 console.log("Game URL preview listener attached.");
            }
            if (iconUrlInput && iconUrlPreview) {
                iconUrlInput.addEventListener('input', () => {
                     const url = iconUrlInput.value.trim();
                     if (url && (url.startsWith('http://') || url.startsWith('https://') || url.startsWith('data:image'))) {
                        console.log("Attempting to preview icon URL:", url);
                         iconUrlPreview.src = url;
                         iconUrlPreview.onerror = () => { // Handle broken image links
                            console.warn("Icon preview failed to load:", url);
                            iconUrlPreview.src = ''; // Clear src on error
                         };
                     } else {
                         iconUrlPreview.src = ''; // Clear preview if invalid/empty
                     }
                });
                 console.log("Icon URL preview listener attached.");
            }
             // Add listener for Edit Icon URL Preview
             if (editIconUrlInput && editIconPreviewContainer) {
                 editIconUrlInput.addEventListener('input', () => {
                     const url = editIconUrlInput.value.trim();
                     const previewImg = editIconPreviewContainer.querySelector('img');
                     if (url && (url.startsWith('http://') || url.startsWith('https://') || url.startsWith('data:image'))) {
                         console.log("Attempting to preview edit icon URL:", url);
                         previewImg.src = url;
                         previewImg.onerror = () => { previewImg.src = ''; }; // Clear on error
                     } else {
                         previewImg.src = ''; // Clear preview
                     }
                 });
                 console.log("Edit Icon URL preview listener attached.");
             }

            // --- Finder Event Listeners ---
             if (playerCountOptionsContainer) {
                 playerCountOptionsContainer.addEventListener('click', (event) => {
                     const button = event.target.closest('.step-button');
                     if (button && button.dataset.players) {
                         event.preventDefault();
                         selectedPlayerCount = button.dataset.players; // Includes "3+" now
                         console.log("Player count selected:", selectedPlayerCount);
                         // Ensure 'Any' category is active when moving to next step
                         finderCategoriesContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category'));
                         finderCategoriesContainer.querySelector('[data-filter="Any"]')?.classList.add('active-category');
                         selectedFinderCategory = 'Any'; // Reset category selection
                         showFinderStep('category-select-step'); // Move to next step
                     }
                 });
                 console.log("Player count listener attached.");
             }
             if (finderCategoriesContainer) {
                 finderCategoriesContainer.addEventListener('click', (event) => {
                      if (event.target.classList.contains('category-button')) {
                        const filterValue = event.target.dataset.filter;
                         console.log("Finder category selected:", filterValue);
                         selectedFinderCategory = filterValue;
                         finderCategoriesContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category'));
                         event.target.classList.add('active-category');
                         runFinder(); // Filter and display results
                    }
                 });
                 console.log("Finder category listener attached.");
             }
             if (restartFinderBtn) {
                 restartFinderBtn.addEventListener('click', () => {
                     console.log("Restarting finder.");
                     selectedPlayerCount = null;
                     selectedFinderCategory = null;
                     finderResultsContainer.innerHTML = '';
                     finderNoResults.style.display = 'none';
                     finderCategoriesContainer.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active-category'));
                     finderCategoriesContainer.querySelector('[data-filter="Any"]')?.classList.add('active-category');
                     showFinderStep('player-count-step');
                 });
                 console.log("Restart Finder button listener attached.");
             }
             if (finderResultsContainer) {
                 finderResultsContainer.addEventListener('click', (event) => {
                    const playButton = event.target.closest('.finder-result-play-btn');
                    if (playButton) {
                         console.log("Finder result play clicked.");
                        const gameUrl = playButton.dataset.gameUrl;
                         const gameTitle = playButton.dataset.gameTitle;
                         const gameCreator = playButton.dataset.gameCreator || 'Unknown';
                        const titleElement = document.getElementById('currentGameTitle');
                        const creatorElement = document.getElementById('currentGameCreator');
                        const frameElement = document.getElementById('gameFrame');
                        const playerViewElement = document.getElementById('game-player-section');

                        if (gameUrl && titleElement && creatorElement && frameElement && playerViewElement) {
                            titleElement.textContent = gameTitle;
                             creatorElement.textContent = `by ${gameCreator}`;
                             frameElement.src = 'about:blank';
                             requestAnimationFrame(() => { frameElement.src = gameUrl; });
                            showView(playerViewElement.id);
                            console.log("    Launched game from finder.");
                         } else {
                             console.error("    FINDER PLAY CLICK ERROR: Missing Player Elements!", { titleEl:!!titleElement, creatorEl:!!creatorElement, frameEl:!!frameElement, playerViewEl:!!playerViewElement });
                            alert("Error loading game components. Check console (F12).");
                        }
                    }
                });
                 console.log("Finder results play button listener attached.");
             }

            // Apps Script Form Submission Listener
            if (supportForm) {
                supportForm.addEventListener('submit', (event) => {
                    event.preventDefault();
                    console.log("Support form submitted via JS to Apps Script.");
                    supportMessageStatus.textContent = 'Submitting...';
                    submitSupportButton.disabled = true;

                    // --- YOUR DEPLOYED WEB APP URL (for doPost) ---
                    const SCRIPT_POST_URL = 'https://script.google.com/macros/s/AKfycbz-oAR3GGVgCkzbpe5rLXq_U4c_eVx2n5W1Ih-lN0fF5fwE11fubZ3R2OGgBcVvQeR7vw/exec';
                    // ---------------------------------

                    if (!SCRIPT_POST_URL || SCRIPT_POST_URL.includes('PASTE_YOUR_WEB_APP_URL_HERE')) { // Keep check
                         supportMessageStatus.textContent = 'Error: Web App URL issue!';
                         submitSupportButton.disabled = false;
                         console.error("Google Apps Script Web App URL issue in the script (POST).");
                         return;
                    }

                    const formData = new FormData(supportForm);

                    fetch(SCRIPT_POST_URL, { // Use the POST URL here
                        method: 'POST',
                        body: formData,
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Response from Apps Script:', data);
                        if (data.result === 'success') {
                            supportMessageStatus.textContent = 'Request Submitted Successfully!';
                            supportForm.reset();
                            // Close the popup after a short delay
                            setTimeout(closeSupportFormPopup, 1500);
                        } else {
                             supportMessageStatus.textContent = 'Submission Failed: ' + (data.message || 'Unknown error');
                             console.error('Apps Script Error:', data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error submitting form to Apps Script:', error);
                        supportMessageStatus.textContent = 'Network Error: Could not submit request. Please try again.';
                    })
                    .finally(() => {
                         submitSupportButton.disabled = false;
                         setTimeout(() => {
                             // Clear status only if it hasn't changed to an error message again
                             if (supportMessageStatus.textContent === 'Request Submitted Successfully!') {
                                 supportMessageStatus.textContent = '';
                             }
                         }, 5000); // Longer delay before clearing success message
                    });
                });
                console.log("Apps Script support form listener attached.");
            }

            // --- Search Input Listener ---
            if (searchInput) {
                searchInput.addEventListener('input', (event) => {
                    debouncedSearch(event.target.value);
                });
                 console.log("Search input listener attached.");
            }


             // --- Admin Button Test Games Listener ---
            if (testAllGamesBtn && gameTestResultsDiv) {
                testAllGamesBtn.addEventListener('click', async () => {
                    console.log("Starting parallel game link test...");
                    gameTestResultsDiv.innerHTML = 'Testing games... Please wait.<br>';
                    gameTestResultsDiv.style.display = 'block';
                    testAllGamesBtn.disabled = true;

                    // Use the data already parsed for the manager if available
                    const gamesToTest = adminGamesData.length > 0 ? adminGamesData : parseGamesFromDOM(); // Fallback if admin panel wasn't opened first
                    if (!gamesToTest || gamesToTest.length === 0) {
                         gameTestResultsDiv.innerHTML = '<b>Error:</b> No games found to test.';
                         testAllGamesBtn.disabled = false;
                         return;
                    }

                    let promises = [];
                    let gameDataForTest = []; // Store info to match results later

                    // 1. Create all fetch promises
                    gamesToTest.forEach(game => {
                        const url = game.url;
                        const title = game.title;
                        gameDataForTest.push({ title: title, url: url }); // Store data

                        if (!url) {
                            promises.push(Promise.reject({ reason: 'Missing URL' }));
                        } else {
                            const fetchPromise = fetch(url, { method: 'HEAD', mode: 'no-cors' })
                                .then(response => ({ status: 'fulfilled' }))
                                .catch(error => {
                                    console.warn(`Test Error: ${title} - ${url}`, error);
                                    throw new Error('Network Error/CORS?');
                                });
                            promises.push(fetchPromise);
                        }
                    });

                    console.log(`Created ${promises.length} test promises.`);

                    // 2. Wait for all promises to settle
                    const results = await Promise.allSettled(promises);
                    console.log("All promises settled.");

                    // 3. Process results and build HTML
                    let resultsHTML = '';
                    let successCount = 0;
                    let errorCount = 0;

                    results.forEach((result, index) => {
                        const title = gameDataForTest[index].title; // Get title using index
                        let statusHTML = '';

                        if (result.status === 'fulfilled') {
                            statusHTML = '<span class="status-ok">OK (Network)</span>';
                            successCount++;
                        } else {
                            const reason = result.reason?.message || result.reason?.reason || 'Unknown Error';
                            statusHTML = `<span class="status-error">${reason}</span>`;
                            errorCount++;
                        }
                        resultsHTML += `<div>${title}: ${statusHTML}</div>`;
                    });

                    gameTestResultsDiv.innerHTML = `<b>Test Complete (${successCount} OK, ${errorCount} Errors):</b><br>` + resultsHTML;
                    testAllGamesBtn.disabled = false;
                    updateAdminDashboard(); // <<< CALL DASHBOARD UPDATE HERE TOO
                    console.log("Game link test finished.");
                });
                console.log("Test All Games button listener attached.");
            }

            // --- Game Manager Edit/Delete Listeners (Event Delegation) ---
            if (gameManagerTableBody) {
                 gameManagerTableBody.addEventListener('click', (event) => {
                     const editButton = event.target.closest('.edit-btn');
                     const deleteButton = event.target.closest('.delete-btn');

                     if (editButton) {
                         const row = editButton.closest('tr');
                         const gameId = row?.dataset.gameId;
                         if (gameId !== undefined) {
                             openEditGameModal(gameId);
                         } else {
                             console.error("Could not find game ID for edit button.");
                         }
                     } else if (deleteButton) {
                         const row = deleteButton.closest('tr');
                         const gameId = row?.dataset.gameId;
                         if (gameId !== undefined) {
                             deleteGame(gameId);
                         } else {
                             console.error("Could not find game ID for delete button.");
                         }
                     }
                 });
                 console.log("Game Manager action listeners attached.");
            }

            // --- Edit Game Modal Button Listeners ---
            if (closeEditGameModal) {
                 closeEditGameModal.addEventListener('click', closeEditGameModal);
                 console.log("Close Edit Modal button listener attached.");
            }
            if (editGameOverlay) {
                 editGameOverlay.addEventListener('click', closeEditGameModal);
                 console.log("Edit Modal overlay listener attached.");
            }
             if (editGameModal) {
                 editGameModal.addEventListener('click', (event) => event.stopPropagation()); // Prevent closing by clicking inside
             }
            if (cancelEditGameBtn) {
                 cancelEditGameBtn.addEventListener('click', closeEditGameModal);
                 console.log("Cancel Edit button listener attached.");
            }
            if (saveGameChangesBtn) {
                 saveGameChangesBtn.addEventListener('click', saveGameEdit);
                 console.log("Save Changes button listener attached.");
            }


            // --- Initial Load Logic ---
             const savedTitle = localStorage.getItem('tabCloakTitle'); const savedFavicon = localStorage.getItem('tabCloakFavicon');
             if (savedTitle && savedFavicon) { console.log("Found saved cloak in localStorage. Applying."); setTabCloak(savedTitle, savedFavicon); }
             else { console.log("No saved cloak found, using default."); resetTabCloak(); }

             // Initial UI update for sign-in is now handled in window.onload
             // Initial parsing of games for admin panel (will happen on first admin view click)


            console.log("--- DOMContentLoaded Initial Setup Complete ---");

        }); // End of DOMContentLoaded listener
    </script>

</body>
</html>
